<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مقارنات مالية | Financial Analyzer</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  margin:0;
  font-family:'Cairo',sans-serif;
  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
  color:#fff;
  overflow-x:hidden;
}

header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:15px 40px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(20px);
  box-shadow:0 4px 30px rgba(0,0,0,0.2);
  position:sticky;
  top:0;
  z-index:1000;
  border-bottom:1px solid rgba(255,255,255,0.2);
}
header img {
  height:50px;
}
nav a {
  color:#fff;
  text-decoration:none;
  margin:0 15px;
  font-weight:600;
  transition:color 0.3s;
}
nav a:hover {
  color:#00d9ff;
}

.container {
  padding:40px;
  max-width:1200px;
  margin:auto;
}
.card {
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(15px);
  border-radius:20px;
  padding:25px;
  margin-bottom:25px;
  box-shadow:0 4px 30px rgba(0,0,0,0.2);
  transition:transform 0.3s ease, box-shadow 0.3s ease;
}
.card:hover {
  transform:translateY(-5px);
  box-shadow:0 10px 40px rgba(0,0,0,0.4);
}

h1 {
  text-align:center;
  margin-bottom:30px;
  font-size:2.2rem;
  color:#00e6ff;
}

.controls {
  display:flex;
  justify-content:center;
  align-items:center;
  gap:20px;
  margin-bottom:30px;
}
select, button {
  padding:10px 20px;
  border-radius:10px;
  border:none;
  outline:none;
  font-family:'Cairo',sans-serif;
  font-weight:600;
  cursor:pointer;
}
select {
  background:rgba(255,255,255,0.1);
  color:#fff;
}
button {
  background:#00e6ff;
  color:#000;
  transition:0.3s;
}
button:hover {
  background:#00a6c7;
}

canvas {
  width:100%!important;
  max-height:400px;
}

.analysis {
  margin-top:30px;
  font-size:1.1rem;
  background:rgba(0,0,0,0.3);
  padding:20px;
  border-radius:15px;
  line-height:1.8;
}
.language-toggle {
  position:absolute;
  top:15px;
  right:20px;
  background:rgba(255,255,255,0.15);
  color:#fff;
  border:none;
  border-radius:8px;
  padding:8px 15px;
  cursor:pointer;
}
.language-toggle:hover {
  background:rgba(255,255,255,0.3);
}
</style>
</head>
<body>
<header>
  <div class="logo">
    <img src="logo.png" alt="Financial Analyzer Logo">
  </div>
  <nav>
    <a href="index.html" data-en="Home" data-ar="الرئيسية">الرئيسية</a>
    <a href="input.html" data-en="Input" data-ar="الإدخال">الإدخال</a>
    <a href="upload.html" data-en="Upload" data-ar="رفع البيانات">رفع البيانات</a>
    <a href="report.html" data-en="Report" data-ar="التقرير">التقرير</a>
    <a href="advanced.html" data-en="Advanced" data-ar="تحليل متقدم">تحليل متقدم</a>
    <a href="dashboard.html" data-en="Dashboard" data-ar="لوحة التحكم">لوحة التحكم</a>
    <a href="comparisons.html" data-en="Comparisons" data-ar="المقارنات">المقارنات</a>
  </nav>
  <button class="language-toggle" id="langBtn">EN</button>
</header>

<div class="container">
  <h1 data-en="Financial Comparisons" data-ar="المقارنات المالية">المقارنات المالية</h1>

  <div class="card controls">
    <select id="year1"></select>
    <select id="year2"></select>
    <button id="compareBtn" data-en="Compare" data-ar="قارن">قارن</button>
  </div>

  <div class="card">
    <canvas id="compareChart"></canvas>
  </div>

  <div class="card analysis" id="analysisText"></div>
</div>

<script>
const langBtn=document.getElementById('langBtn');
let currentLang='ar';

function translatePage(){
  document.querySelectorAll('[data-en]').forEach(el=>{
    el.textContent = el.getAttribute(`data-${currentLang}`);
  });
  document.documentElement.dir = currentLang==='ar'?'rtl':'ltr';
  langBtn.textContent = currentLang==='ar'?'EN':'AR';
}

langBtn.addEventListener('click',()=>{
  currentLang=currentLang==='ar'?'en':'ar';
  translatePage();
});

translatePage();

// --- Load data from LocalStorage
const storedData = JSON.parse(localStorage.getItem('financialData')) || {
  "2022": { revenue: 500000, profit: 120000, assets: 1000000, liabilities: 400000 },
  "2023": { revenue: 600000, profit: 150000, assets: 1200000, liabilities: 500000 }
};

const year1Select=document.getElementById('year1');
const year2Select=document.getElementById('year2');
const analysisText=document.getElementById('analysisText');

Object.keys(storedData).forEach(y=>{
  year1Select.innerHTML+=`<option value="${y}">${y}</option>`;
  year2Select.innerHTML+=`<option value="${y}">${y}</option>`;
});

let chart;

document.getElementById('compareBtn').addEventListener('click',()=>{
  const y1=year1Select.value;
  const y2=year2Select.value;
  if(y1===y2){
    alert(currentLang==='ar'?'اختر سنتين مختلفتين للمقارنة':'Select two different years');
    return;
  }
  const d1=storedData[y1];
  const d2=storedData[y2];

  const labels=['الإيرادات','الأرباح','الأصول','الالتزامات'];
  const enLabels=['Revenue','Profit','Assets','Liabilities'];

  const data1=[d1.revenue,d1.profit,d1.assets,d1.liabilities];
  const data2=[d2.revenue,d2.profit,d2.assets,d2.liabilities];

  if(chart) chart.destroy();

  chart=new Chart(document.getElementById('compareChart'),{
    type:'bar',
    data:{
      labels: currentLang==='ar'?labels:enLabels,
      datasets:[
        {label:y1,data:data1,backgroundColor:'#00e6ffaa'},
        {label:y2,data:data2,backgroundColor:'#ff7b00aa'}
      ]
    },
    options:{
      responsive:true,
      scales:{y:{beginAtZero:true}}
    }
  });

  const growth=((d2.profit-d1.profit)/d1.profit*100).toFixed(2);
  const risk=(d2.liabilities/d2.assets*100).toFixed(2);

  const arText=`تحليل النتائج بين عام ${y1} و${y2}:\n
  نسبة نمو الأرباح: ${growth}%.\n
  نسبة المديونية: ${risk}%.\n
  ${
    growth>0
      ? 'تشير النتائج إلى تحسن إيجابي في الأداء المالي وزيادة ربحية المؤسسة.'
      : 'تظهر النتائج تراجعًا في الأداء المالي مما يتطلب مراجعة الاستراتيجيات التشغيلية.'
  }`;

  const enText=`Analysis between ${y1} and ${y2}:\n
  Profit Growth: ${growth}%\n
  Debt Ratio: ${risk}%\n
  ${
    growth>0
      ? 'The results indicate positive financial performance and improved profitability.'
      : 'Results show a decline in performance requiring operational review.'
  }`;

  analysisText.textContent = currentLang==='ar'?arText:enText;
});
</script>
</body>
</html>

const advancedTranslations={ar:{pageTitle:"ุงูุชุญูููุงุช ุงููุชูุฏูุฉ โ ุงููุญูู ุงููุงูู",pageHeader:"ุงูุชุญูููุงุช ุงููุชูุฏูุฉ",pageSubheader:"ุงุณุชุฎุฏู ุฃุฏูุงุช ุชุญููููุฉ ูุชุฎุตุตุฉ ููุญุตูู ุนูู ุฑุคู ุฃุนูู ุญูู ุฃุฏุงุก ุนููู.",tabRatios:"ุงููุณุจ ุงููุงููุฉ",tabBreakeven:"ุชุญููู ุงูุชุนุงุฏู",tabDupont:"ุชุญููู ุฏูุจููุช",tabVertical:"ุงูุชุญููู ุงูุฑุฃุณู",tabZScore:"ูููุฐุฌ Z-Score",tabCashFlow:"ุชุญููู ุงูุชุฏููุงุช ุงูููุฏูุฉ",tabEVA:"ุงููููุฉ ุงูุงูุชุตุงุฏูุฉ ุงููุถุงูุฉ (EVA)",tabHorizontal:"ุงูุชุญููู ุงูุฃููู",tabCCC:"ุฏูุฑุฉ ุงูุชุญูู ุงูููุฏู",tabScenario:"ุชุญููู ุงูุณููุงุฑูู",summaryTitle:"ุงูููุฎุต ุงูุฐูู",alertsTitle:"ุชูุจููุงุช ููุคุดุฑุงุช ุฎุทุฑ",thRatio:"ุงููุณุจุฉ",thValue:"ุงููููุฉ",thComment:"ุชุนููู ุชุญูููู",liquidityRatios:"ูุคุดุฑุงุช ุงูุณูููุฉ",profitabilityRatios:"ูุคุดุฑุงุช ุงูุฑุจุญูุฉ",leverageRatios:"ูุคุดุฑุงุช ุงูุฑูุงูุน ูุงููุฏููููุฉ",activityRatios:"ูุคุดุฑุงุช ุงููุดุงุท",valuationRatios:"ูุคุดุฑุงุช ุงูุชูููู",currentRatio:"ูุณุจุฉ ุงูุชุฏุงูู",currentRatio_comment_high:"ุณูููุฉ ููุชุงุฒุฉ...",currentRatio_comment_good:"ุณูููุฉ ุฌูุฏุฉ...",currentRatio_comment_low:"ูุคุดุฑ ุฎุทุฑ...",quickRatio:"ูุณุจุฉ ุงูุณูููุฉ ุงูุณุฑูุนุฉ",quickRatio_comment_good:"ูุฏุฑุฉ ุฌูุฏุฉ...",quickRatio_comment_low:"ูุคุดุฑ ุฎุทุฑ...",netWorkingCapital:"ุตุงูู ุฑุงุณ ุงููุงู ุงูุนุงูู",netWorkingCapital_comment_positive:"ูุถุน ุตุญู.",netWorkingCapital_comment_negative:"ูุคุดุฑ ุฎุทุฑ.",cashRatio:"ูุณุจุฉ ุงูููุฏ",cashRatio_comment_good:"ูุฏุฑุฉ ูููุฉ ุฌุฏุงู.",cashRatio_comment_low:"ุงุนุชูุงุฏ ููุฎูุถ.",inventoryTurnover:"ูุนุฏู ุฏูุฑุงู ุงููุฎุฒูู",inventoryTurnover_comment_high:"ููุงุกุฉ ุนุงููุฉ.",inventoryTurnover_comment_low:"ุถุนู ุฃู ุฑููุฏ.",assetTurnover:"ูุนุฏู ุฏูุฑุงู ุงูุฃุตูู",assetTurnover_comment_high:"ููุงุกุฉ ููุชุงุฒุฉ.",assetTurnover_comment_low:"ููุงุกุฉ ููุฎูุถุฉ.",receivablesTurnover:"ูุนุฏู ุฏูุฑุงู ุงูุนููุงุก",receivablesTurnover_comment_high:"ุชุญุตูู ููู.",receivablesTurnover_comment_low:"ุชุจุงุทุค ูู ุงูุชุญุตูู.",avgCollectionPeriod:"ูุชูุณุท ูุชุฑุฉ ุงูุชุญุตูู",avgCollectionPeriod_comment_low:"ุณุฑุนุฉ ููุชุงุฒุฉ.",avgCollectionPeriod_comment_high:"ูุชุฑุฉ ุทูููุฉ.",debtToEquity:"ูุณุจุฉ ุงูุฏููู ูุญููู ุงูููููุฉ",debtToEquity_comment_low:"ูููู ุขูู.",debtToEquity_comment_good:"ุชูุงุฒู ุฌูุฏ.",debtToEquity_comment_high:"ุฏูู ูุฑุชูุน.",debtToAssets:"ูุณุจุฉ ุงูุฏููู ููุฃุตูู",debtToAssets_comment_low:"ูุถุน ุขูู.",debtToAssets_comment_high:"ูุฎุงุทุฑ ูุฑุชูุนุฉ.",interestCoverageRatio:"ุนุฏุฏ ูุฑุงุช ุชุบุทูุฉ ุงูููุงุฆุฏ",interestCoverageRatio_comment_safe:"ูุฏุฑุฉ ููุชุงุฒุฉ.",interestCoverageRatio_comment_risk:"ุฎุทุฑ.",financialLeverage:"ุงูุฑุงูุนุฉ ุงููุงููุฉ",financialLeverage_comment_high:"ุงุนุชูุงุฏ ูุจูุฑ.",financialLeverage_comment_low:"ุงุนุชูุงุฏ ููุฎูุถ.",netProfitMargin:"ูุงูุด ุตุงูู ุงูุฑุจุญ",netProfitMargin_comment_high:"ุฑุจุญูุฉ ููุชุงุฒุฉ.",netProfitMargin_comment_avg:"ุฑุจุญูุฉ ููุจููุฉ.",netProfitMargin_comment_low:"ุฎุณุงุฆุฑ.",grossProfitMargin:"ูุณุจุฉ ูุฌูู ุงูุฑุจุญ",grossProfitMargin_comment_high:"ูุงูุด ููู.",grossProfitMargin_comment_low:"ูุงูุด ุถุนูู.",roa:"ุงูุนุงุฆุฏ ุนูู ุงูุฃุตูู (ROA)",roa_comment_high:"ููุงุกุฉ ุนุงููุฉ.",roa_comment_low:"ููุงุกุฉ ููุฎูุถุฉ.",roe:"ุงูุนุงุฆุฏ ุนูู ุญููู ุงูููููุฉ (ROE)",roe_comment_high:"ุนุงุฆุฏ ููุชุงุฒ.",roe_comment_low:"ุนุงุฆุฏ ุถุนูู.",eps:"ุฑุจุญูุฉ ุงูุณูู (EPS)",eps_comment_positive:"ุฑุจุญ ููุณูู.",eps_comment_negative:"ุฎุณุงุฑุฉ ููุณูู.",peRatio:"ูุถุงุนู ุงูุฑุจุญูุฉ (P/E)",peRatio_comment:"ููุงุฑู ุจุงููุทุงุน.",pbRatio:"ูุนุฏู ุงูุณุนุฑ ูููููุฉ ุงูุฏูุชุฑูุฉ (P/B)",pbRatio_comment:"ููุงุฑู ุณุนุฑ ุงูุณูู ุจูููุชู ุงูุฏูุชุฑูุฉ.",dividendYield:"ูุนุฏู ุงูุฑุจุญ ุงูููุฒุน ููุณูู",dividendYield_comment:"ูุงู ูููุณุชุซูุฑูู ุงูุจุงุญุซูู ุนู ุฏุฎู.",payoutRatio:"ูุณุจุฉ ุงูุชูุฒูุน",payoutRatio_comment:"ูุณุจุฉ ููุฎูุถุฉ ูุฏ ุชุนูู ุฅุนุงุฏุฉ ุงุณุชุซูุงุฑ.",externalDataWarning:"ุชุชุทูุจ ูุฏุฎูุงุช ุฅุถุงููุฉ (ุนุฏุฏ ุงูุฃุณููุ ุณุนุฑ ุงูุณููุ ุฅูุฎ).",noDataForAdvanced:"ูุง ุชูุฌุฏ ุจูุงูุงุช ููุงุฆู ูุงููุฉ ููุฌูุฒุฉ. ูุฑุฌู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ' ุฃููุงู ูุฅูุดุงุก ุงูููุงุฆู.",summary_ok:"ุงููุถุน ุงููุงูู ูุจุฏู ูุณุชูุฑูุง...",summary_risk:"ุชูุฌุฏ ุจุนุถ ูุคุดุฑุงุช ุงูุฎุทุฑ...",alert_liquidity_risk:"๐ด ุฎุทุฑ ุณูููุฉ...",alert_leverage_risk:"๐ก ุชูุจูู ุฏูู ูุฑุชูุน...",alert_profit_risk:"๐ด ุฎุทุฑ ุฑุจุญูุฉ...",alert_ok:"๐ข ูุง ุชูุฌุฏ ูุคุดุฑุงุช ุฎุทุฑ ุญุฑุฌุฉ...",noDataForRatios:"ูุง ุชูุฌุฏ ุจูุงูุงุช ูุงููุฉ ูุญุณุงุจ ุงููุณุจ.",beInputTitle:"ูุฏุฎูุงุช ุงูุญุณุงุจ",labelFixedCosts:"ุฅุฌูุงูู ุงูุชูุงููู ุงูุซุงุจุชุฉ",labelVariableCost:"ุงูุชูููุฉ ุงููุชุบูุฑุฉ ูููุญุฏุฉ",labelSellingPrice:"ุณุนุฑ ุจูุน ุงููุญุฏุฉ",btnCalculate:"ุงุญุณุจ",beResultsTitle:"ุงููุชุงุฆุฌ",bepUnits:"ููุทุฉ ุงูุชุนุงุฏู (ุจุงููุญุฏุงุช)",bepValue:"ููุทุฉ ุงูุชุนุงุฏู (ุจุงููููุฉ)",beChartTitle:"ุฑุณู ุจูุงูู ูููุทุฉ ุงูุชุนุงุฏู",errorPrice:"ุณุนุฑ ุงูุจูุน ูุฌุจ ุฃู ูููู ุฃุนูู.",errorPositiveValues:"ุฃุฏุฎู ููู ููุฌุจุฉ.",revenue:"ุงูุฅูุฑุงุฏุงุช",totalCosts:"ุฅุฌูุงูู ุงูุชูุงููู",fixedCosts:"ุงูุชูุงููู ุงูุซุงุจุชุฉ",unitsSold:"ุงููุญุฏุงุช ุงููุจุงุนุฉ",value:"ุงููููุฉ",dupontTitle:"ุชุญููู ุฏูุจููุช",dupontDesc:"ุชูููู ุงูุนุงุฆุฏ ุนูู ุญููู ุงูููููุฉ (ROE)...",dupontEquation:"ูุนุงุฏูุฉ ุฏูุจููุช:",dupontCompNPM:"ูุงูุด ุตุงูู ุงูุฑุจุญ",dupontCompAT:"ุฏูุฑุงู ุงูุฃุตูู",dupontCompEM:"ูุถุงุนู ุงูููููุฉ",dupontCompROE:"ุงูุนุงุฆุฏ ุนูู ุงูููููุฉ",dupontDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ูุชุญููู ุฏูุจููุช (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",dupontInterpretationHighROE:"๐ข ุงูุนุงุฆุฏ ุงููุฑุชูุน ุนูู ุญููู ุงูููููุฉ ูุฏููุน ุจุดูู ุฃุณุงุณู ุจู:",dupontInterpretationLowROE:"๐ก ุงูุนุงุฆุฏ ุงูููุฎูุถ ุนูู ุญููู ุงูููููุฉ ูุชุฃุซุฑ ุจู:",dupontFactorProfitability:"ุฑุจุญูุฉ ุชุดุบูููุฉ ูููุฉ (ูุงูุด ุฑุจุญ ุฌูุฏ).",dupontFactorEfficiency:"ููุงุกุฉ ุฃุตูู ุนุงููุฉ (ุฏูุฑุงู ุฃุตูู ุณุฑูุน).",dupontFactorLeverage:"ุงุณุชุฎุฏุงู ุงูุฑูุน ุงููุงูู (ูุถุงุนู ููููุฉ ูุฑุชูุน).",dupontFactorLowProfitability:"ุฑุจุญูุฉ ุชุดุบูููุฉ ุถุนููุฉ (ูุงูุด ุฑุจุญ ููุฎูุถ).",dupontFactorLowEfficiency:"ููุงุกุฉ ุฃุตูู ููุฎูุถุฉ (ุฏูุฑุงู ุฃุตูู ุจุทูุก).",dupontFactorLowLeverage:"ุงุนุชูุงุฏ ููุฎูุถ ุนูู ุงูุฏููู (ูุถุงุนู ููููุฉ ููุฎูุถ).",verticalTitle:"ุงูุชุญููู ุงูุฑุฃุณู",verticalDesc:"ูุนุฑุถ ุงูุจููุฏ ููุณุจุฉ ูุฆููุฉ...",verticalDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ููุชุญููู ุงูุฑุฃุณู (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",verticalBS:"ุงูููุฒุงููุฉ (% ูู ุงูุฃุตูู)",verticalIS:"ุงูุฏุฎู (% ูู ุงูุฅูุฑุงุฏุงุช)",verticalAccount:"ุงูุญุณุงุจ",verticalValue:"ุงููููุฉ",verticalPercent:"ุงููุณุจุฉ %",verticalInterpretationTitle:"ุฃุจุฑุฒ ุงูููุงุญุธุงุช:",verticalLargestAsset:"ุฃูุจุฑ ุจูุฏ ุฃุตูู ูู {account} ุจูุณุจุฉ {percent}.",verticalLargestLiability:"ุฃูุจุฑ ุจูุฏ ุฎุตูู ูู {account} ุจูุณุจุฉ {percent} (ูู ุฅุฌูุงูู ุงูุฎุตูู ูุญููู ุงูููููุฉ).",verticalLargestEquity:"ุฃูุจุฑ ุจูุฏ ุญููู ููููุฉ ูู {account} ุจูุณุจุฉ {percent} (ูู ุฅุฌูุงูู ุงูุฎุตูู ูุญููู ุงูููููุฉ).",verticalLargestExpense:"ุฃูุจุฑ ุจูุฏ ูุตุฑููุงุช (ุบูุฑ ุชูููุฉ ุงูุจุถุงุนุฉ) ูู {account} ุจูุณุจุฉ {percent} ูู ุงูุฅูุฑุงุฏุงุช.",verticalGrossMarginComment:"ูุงูุด ุงูุฑุจุญ ุงูุฅุฌูุงูู ูุจูุบ {percent}.",zscoreTitle:"ูููุฐุฌ Altman Z-Score",zscoreDesc:"ูููุฐุฌ ููุชูุจุค ุจุงูุฅููุงุณ...",zscoreDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ูุญุณุงุจ Z-Score (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",zscoreValueLabel:"ูููุฉ Z-Score:",zscoreInterpretation:"ุงูุชูุณูุฑ:",zscoreZoneSafe:"๐ข ููุทูุฉ ุขููุฉ",zscoreZoneGrey:"๐ก ููุทูุฉ ุฑูุงุฏูุฉ",zscoreZoneDistress:"๐ด ููุทูุฉ ุงูุฎุทุฑ",zscoreComponents:"ููููุงุช ุงููููุฐุฌ:",zscoreX1:"X1 (ุฑุฃุณ ุงููุงู ุงูุนุงูู / ุงูุฃุตูู)",zscoreX2:"X2 (ุงูุฃุฑุจุงุญ ุงููุญุชุฌุฒุฉ / ุงูุฃุตูู)",zscoreX3:"X3 (ุงูุฃุฑุจุงุญ ู.ู.ุถ / ุงูุฃุตูู)",zscoreX4:"X4 (ุญููู ุงูููููุฉ / ุงูุฎุตูู)",zscoreX5:"X5 (ุงูุฅูุฑุงุฏุงุช / ุงูุฃุตูู)",zscoreRetainedEarningsNotFound:"(ุฃุฑุจุงุญ ูุญุชุฌุฒุฉ ุบูุฑ ููุฌูุฏุฉ)",cfTitle:"ุชุญููู ุงูุชุฏููุงุช ุงูููุฏูุฉ (ุชูุฏูุฑู)",cfDesc:"ุชูุฏูุฑ ููุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ...",cfDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ูุชูุฏูุฑ ุงูุชุฏููุงุช (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",cfStmtTitle:"ูุงุฆูุฉ ุงูุชุฏููุงุช ุงูููุฏูุฉ ุงูููุฏุฑุฉ",cfNetIncome:"ุตุงูู ุงูุฏุฎู",cfDepreciationAmortization:"ุงูุฅููุงู (ููุฏุฑ)",cfChangesWC:"ุงูุชุบูุฑุงุช ูู ุฑุฃุณ ุงููุงู ุงูุนุงูู (ููุฏุฑ)",cfOperating:"ุงูุชุฏูู ุงูุชุดุบููู",cfInvesting:"ุงูุชุฏูู ุงูุงุณุชุซูุงุฑู (ููุฏุฑ)",cfFinancing:"ุงูุชุฏูู ุงูุชููููู (ููุฏุฑ)",cfNetChange:"ุตุงูู ุงูุชุบูุฑ ุงูููุฏู",cfRatiosTitle:"ูุณุจ ุงูุชุฏููุงุช ุงูููุฏูุฉ",cfRatioOCF:"ูุณุจุฉ ุงูุชุฏูู ุงูุชุดุบููู",cfRatioFCF:"ุงูุชุฏูู ุงูููุฏู ุงูุญุฑ (ููุฏุฑ)",cfInterpretationPositiveOCF:"๐ข ุงูุนูููุงุช ุชููุฏ ููุฏูุง.",cfInterpretationNegativeOCF:"๐ด ุงูุนูููุงุช ุชุณุชููู ููุฏูุง.",cfInterpretationFCF:"ุงูุชุฏูู ุงูููุฏู ุงูุญุฑ...",evaInputTitle:"ูุฏุฎูุงุช ุญุณุงุจ (EVA)",evaInputDesc:"ูุชุทูุจ ุงูุชุฑุงุถุงุช ุฎุงุฑุฌูุฉ.",labelWACC:"ูุชูุณุท ุชูููุฉ ุฑุฃุณ ุงููุงู (WACC)",labelTaxRate:"ูุนุฏู ุงูุถุฑูุจุฉ",evaResultsTitle:"ูุชุงุฆุฌ ุชุญููู (EVA)",evaDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ูุญุณุงุจ (EVA) (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",evaValueLabel:"ุงููููุฉ ุงูุงูุชุตุงุฏูุฉ ุงููุถุงูุฉ (EVA):",evaInterpretation:"ุงูุชูุณูุฑ:",evaInterpretationPositive:"๐ข ุฎูู ูููููุฉ.",evaInterpretationNegative:"๐ด ุชุฏููุฑ ูููููุฉ.",evaComponents:"ููููุงุช ุงูุญุณุงุจ:",evaNOPAT:"ุตุงูู ุงูุฑุจุญ ุงูุชุดุบููู ุจุนุฏ ุงูุถุฑุงุฆุจ",evaInvestedCapital:"ุฑุฃุณ ุงููุงู ุงููุณุชุซูุฑ",evaCapitalCharge:"ุชูููุฉ ุฑุฃุณ ุงููุงู",horizontalTitle:"ุงูุชุญููู ุงูุฃููู (ุชุญููู ุงูุงุชุฌุงู)",horizontalDesc:"ููุงุฑู ุจููุฏ ุงูููุงุฆู ุงููุงููุฉ ุนุจุฑ ูุชุฑุชูู ุฒูููุชูู (ุงูุญุงููุฉ ูุงูุณุงุจูุฉุ ุฅู ูุฌุฏุช).",horizontalDataWarning:"ูุง ุชูุฌุฏ ุจูุงูุงุช ูุชุฑุฉ ุณุงุจูุฉ (financialDataPrevious). ูุฑุฌู ุงูุชุฃูุฏ ูู ุฅุฏุฎุงู ุจูุงูุงุช ุงููุชุฑุฉ ุงูุณุงุจูุฉ ูุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ'.",horizontalIS:"ูุงุฆูุฉ ุงูุฏุฎู - ููุงุฑูุฉ ุงููุชุฑุงุช",horizontalBS:"ุงูููุฒุงููุฉ ุงูุนููููุฉ - ููุงุฑูุฉ ุงููุชุฑุงุช",horizontalAccount:"ุงูุญุณุงุจ",horizontalCurrentPeriod:"ุงููุชุฑุฉ ุงูุญุงููุฉ",horizontalPreviousPeriod:"ุงููุชุฑุฉ ุงูุณุงุจูุฉ",horizontalChangeAbs:"ุงูุชุบูุฑ ($)",horizontalChangePct:"ุงูุชุบูุฑ (%)",cccTitle:"ุฏูุฑุฉ ุงูุชุญูู ุงูููุฏู (CCC)",cccDesc:"ุชููุณ ุงูููุช ุจุงูุฃูุงู ูุชุญููู ุงูุงุณุชุซูุงุฑุงุช ูู ุงููุฎุฒูู ูุงูููุงุฑุฏ ุฅูู ููุฏ.",cccDataWarning:"ุจูุงูุงุช ุบูุฑ ูุงููุฉ ูุญุณุงุจ CCC (ุชุฃูุฏ ูู ุชุดุบูู ุตูุญุฉ 'ุงูุชูุงุฑูุฑ').",cccValueLabel:"ุฏูุฑุฉ ุงูุชุญูู ุงูููุฏู (ุฃูุงู):",cccInterpretation:"ุงูุชูุณูุฑ:",cccInterpretationShort:"๐ข ุฏูุฑุฉ ูุตูุฑุฉ: ููุงุกุฉ ุนุงููุฉ.",cccInterpretationLong:"๐ก ุฏูุฑุฉ ุทูููุฉ: ุจุทุก ูู ุจูุน ุงููุฎุฒูู ุฃู ุงูุชุญุตูู.",cccComponents:"ููููุงุช ุงูุญุณุงุจ (ุฃูุงู):",cccDSO:"ูุชูุณุท ูุชุฑุฉ ุงูุชุญุตูู (DSO)",cccDIO:"ูุชูุณุท ูุชุฑุฉ ุงูุชุฎุฒูู (DIO)",cccDPO:"ูุชูุณุท ูุชุฑุฉ ุงูุณุฏุงุฏ ููููุฑุฏูู (DPO)",scenarioTitle:"ุชุญููู ุงูุณููุงุฑูู (ุนูู ููุทุฉ ุงูุชุนุงุฏู)",scenarioDesc:"ุงุฎุชุจุฑ ุชุฃุซูุฑ ุชุบููุฑ ุงูุงูุชุฑุงุถุงุช ุนูู ููุทุฉ ุงูุชุนุงุฏู.",scenarioInputs:"ุชุบููุฑ ุงูุงูุชุฑุงุถุงุช (%):",scenarioFixedCostsLabel:"ุงูุชูุงููู ุงูุซุงุจุชุฉ",scenarioVariableCostLabel:"ุงูุชูููุฉ ุงููุชุบูุฑุฉ ูููุญุฏุฉ",scenarioSellingPriceLabel:"ุณุนุฑ ุจูุน ุงููุญุฏุฉ",scenarioRunBtn:"ุงุฎุชุจุฑ ุงูุณููุงุฑูู",scenarioResults:"ุงููุชุงุฆุฌ:",scenarioBaseCaseInfo:"ุงูููู ุงูุฃุตููุฉ ูุฃุฎูุฐุฉ ูู ุชุจููุจ ุชุญููู ุงูุชุนุงุฏู.",scenarioMetric:"ุงููููุงุณ",scenarioBaseValue:"ุงููููุฉ ุงูุฃุตููุฉ",scenarioNewValue:"ุงููููุฉ ุงูุฌุฏูุฏุฉ",scenarioChange:"ุงูุชุบูุฑ (%)",externalInputsTitle:"ูุฏุฎูุงุช ุงูุชูููู ุงูุฅุถุงููุฉ",labelNumShares:"ุนุฏุฏ ุงูุฃุณูู ุงููุงุฆูุฉ",labelMarketPrice:"ุณุนุฑ ุงูุณูู ุงูุณููู",labelTotalDividends:"ุฅุฌูุงูู ุงูุชูุฒูุนุงุช ุงูููุฏูุฉ",btnUpdateValuation:"ุชุญุฏูุซ ูุคุดุฑุงุช ุงูุชูููู",exportPdf:"ุชุตุฏูุฑ PDF"},en:{pageTitle:"Advanced Analytics โ Financial Analyzer",pageHeader:"Advanced Analytics",pageSubheader:"Use specialized analytical tools for deeper insights into your business performance.",tabRatios:"Financial Ratios",tabBreakeven:"Break-even Analysis",tabDupont:"DuPont Analysis",tabVertical:"Vertical Analysis",tabZScore:"Altman Z-Score",tabCashFlow:"Cash Flow Analysis",tabEVA:"Economic Value Added (EVA)",tabHorizontal:"Horizontal Analysis",tabCCC:"Cash Conversion Cycle",tabScenario:"Scenario Analysis",summaryTitle:"Smart Summary",alertsTitle:"Alerts & Risk Indicators",thRatio:"Ratio",thValue:"Value",thComment:"Analytical Comment",liquidityRatios:"Liquidity Indicators",profitabilityRatios:"Profitability Indicators",leverageRatios:"Leverage & Indebtedness Indicators",activityRatios:"Activity Indicators",valuationRatios:"Valuation Indicators",currentRatio:"Current Ratio",currentRatio_comment_high:"Excellent liquidity...",currentRatio_comment_good:"Good liquidity...",currentRatio_comment_low:"Risk indicator...",quickRatio:"Quick Ratio",quickRatio_comment_good:"Good ability...",quickRatio_comment_low:"Risk indicator...",netWorkingCapital:"Net Working Capital",netWorkingCapital_comment_positive:"Healthy position.",netWorkingCapital_comment_negative:"Risk indicator.",cashRatio:"Cash Ratio",cashRatio_comment_good:"Very strong ability.",cashRatio_comment_low:"Low reliance.",inventoryTurnover:"Inventory Turnover",inventoryTurnover_comment_high:"High efficiency.",inventoryTurnover_comment_low:"Weak or obsolete.",assetTurnover:"Asset Turnover",assetTurnover_comment_high:"Excellent efficiency.",assetTurnover_comment_low:"Low efficiency.",receivablesTurnover:"Receivables Turnover",receivablesTurnover_comment_high:"Strong collection.",receivablesTurnover_comment_low:"Slowness in collecting.",avgCollectionPeriod:"Average Collection Period",avgCollectionPeriod_comment_low:"Excellent speed.",avgCollectionPeriod_comment_high:"Long period.",debtToEquity:"Debt to Equity Ratio",debtToEquity_comment_low:"Safe structure.",debtToEquity_comment_good:"Good balance.",debtToEquity_comment_high:"High debt.",debtToAssets:"Debt to Assets Ratio",debtToAssets_comment_low:"Safe position.",debtToAssets_comment_high:"High risk.",interestCoverageRatio:"Interest Coverage Ratio",interestCoverageRatio_comment_safe:"Excellent ability.",interestCoverageRatio_comment_risk:"Risk.",financialLeverage:"Financial Leverage",financialLeverage_comment_high:"High reliance.",financialLeverage_comment_low:"Low reliance.",grossProfitMargin:"Gross Profit Margin",grossProfitMargin_comment_high:"Strong margin.",grossProfitMargin_comment_low:"Weak margin.",netProfitMargin:"Net Profit Margin",netProfitMargin_comment_high:"Excellent profitability.",netProfitMargin_comment_avg:"Acceptable profitability.",netProfitMargin_comment_low:"Losses.",roa:"Return on Assets (ROA)",roa_comment_high:"High efficiency.",roa_comment_low:"Low efficiency.",roe:"Return on Equity (ROE)",roe_comment_high:"Excellent return.",roe_comment_low:"Weak return.",eps:"Earnings Per Share (EPS)",eps_comment_positive:"Profit per share.",eps_comment_negative:"Loss per share.",peRatio:"P/E Ratio",peRatio_comment:"Compare to industry.",pbRatio:"Price-to-Book (P/B) Ratio",pbRatio_comment:"Compares market price to book value.",dividendYield:"Dividend Yield",dividendYield_comment:"Important for income investors.",payoutRatio:"Payout Ratio",payoutRatio_comment:"Low ratio may mean reinvesting.",externalDataWarning:"Requires additional inputs (No. Shares, Market Price, etc.).",noDataForAdvanced:"No processed financial statements found. Please run the 'Report' page first to generate statements.",summary_ok:"Financial situation appears stable...",summary_risk:"Some risk indicators are present...",alert_liquidity_risk:"๐ด Liquidity Risk...",alert_leverage_risk:"๐ก High Debt Warning...",alert_profit_risk:"๐ด Profitability Risk...",alert_ok:"๐ข No critical risk indicators found...",noDataForRatios:"Not enough data to calculate ratios.",beInputTitle:"Calculation Inputs",labelFixedCosts:"Total Fixed Costs",labelVariableCost:"Variable Cost per Unit",labelSellingPrice:"Selling Price per Unit",btnCalculate:"Calculate",beResultsTitle:"Results",bepUnits:"Break-even Point (Units)",bepValue:"Break-even Point (Value)",beChartTitle:"Break-even Chart",errorPrice:"Selling price must be higher.",errorPositiveValues:"Enter positive values.",revenue:"Revenue",totalCosts:"Total Costs",fixedCosts:"Fixed Costs",unitsSold:"Units Sold",value:"Value",dupontTitle:"DuPont Analysis",dupontDesc:"Breaking down Return on Equity (ROE)...",dupontEquation:"DuPont Equation:",dupontCompNPM:"Net Profit Margin",dupontCompAT:"Asset Turnover",dupontCompEM:"Equity Multiplier",dupontCompROE:"Return on Equity",dupontDataWarning:"Insufficient data for DuPont analysis (Ensure 'Report' page was run).",dupontInterpretationHighROE:"๐ข High ROE is primarily driven by:",dupontInterpretationLowROE:"๐ก Low ROE is impacted by:",dupontFactorProfitability:"Strong operating profitability (good profit margin).",dupontFactorEfficiency:"High asset efficiency (fast asset turnover).",dupontFactorLeverage:"Use of financial leverage (high equity multiplier).",dupontFactorLowProfitability:"Weak operating profitability (low profit margin).",dupontFactorLowEfficiency:"Low asset efficiency (slow asset turnover).",dupontFactorLowLeverage:"Low reliance on debt (low equity multiplier).",verticalTitle:"Vertical Analysis",verticalDesc:"Displays items as a percentage...",verticalDataWarning:"Insufficient data for Vertical Analysis (Ensure 'Report' page was run).",verticalBS:"Balance Sheet (% of Assets)",verticalIS:"Income Statement (% of Revenue)",verticalAccount:"Account",verticalValue:"Value",verticalPercent:"Percent %",verticalInterpretationTitle:"Key Observations:",verticalLargestAsset:"The largest asset item is {account} at {percent}.",verticalLargestLiability:"The largest liability item is {account} at {percent} (of Total L+E).",verticalLargestEquity:"The largest equity item is {account} at {percent} (of Total L+E).",verticalLargestExpense:"The largest expense item (excl. COGS) is {account} at {percent} of Revenue.",verticalGrossMarginComment:"Gross Profit Margin is {percent}.",zscoreTitle:"Altman Z-Score",zscoreDesc:"Bankruptcy prediction model...",zscoreDataWarning:"Insufficient data for Z-Score (Ensure 'Report' page was run).",zscoreValueLabel:"Z-Score Value:",zscoreInterpretation:"Interpretation:",zscoreZoneSafe:"๐ข Safe Zone",zscoreZoneGrey:"๐ก Grey Zone",zscoreZoneDistress:"๐ด Distress Zone",zscoreComponents:"Model Components:",zscoreX1:"X1 (WC / Assets)",zscoreX2:"X2 (RE / Assets)",zscoreX3:"X3 (EBIT / Assets)",zscoreX4:"X4 (Equity / Liab.)",zscoreX5:"X5 (Revenue / Assets)",zscoreRetainedEarningsNotFound:"(RE not found)",cfTitle:"Cash Flow Analysis (Est.)",cfDesc:"Estimate of cash flow statement...",cfDataWarning:"Insufficient data for Cash Flow est. (Ensure 'Report' page was run).",cfStmtTitle:"Estimated Cash Flow Statement",cfNetIncome:"Net Income",cfDepreciationAmortization:"Depr. & Amort. (Est.)",cfChangesWC:"Changes in Working Capital (Est.)",cfOperating:"Operating CF",cfInvesting:"Investing CF (Est.)",cfFinancing:"Financing CF (Est.)",cfNetChange:"Net Change in Cash",cfRatiosTitle:"Cash Flow Ratios",cfRatioOCF:"Operating CF Ratio",cfRatioFCF:"Free Cash Flow (Est.)",cfInterpretationPositiveOCF:"๐ข Operations generate cash.",cfInterpretationNegativeOCF:"๐ด Operations consume cash.",cfInterpretationFCF:"Free Cash Flow...",evaInputTitle:"EVA Calculation Inputs",evaInputDesc:"Requires external assumptions.",labelWACC:"WACC",labelTaxRate:"Tax Rate",evaResultsTitle:"EVA Analysis Results",evaDataWarning:"Insufficient data for EVA (Ensure 'Report' page was run).",evaValueLabel:"Economic Value Added (EVA):",evaInterpretation:"Interpretation:",evaInterpretationPositive:"๐ข Value Creation.",evaInterpretationNegative:"๐ด Value Destruction.",evaComponents:"Calculation Components:",evaNOPAT:"NOPAT",evaInvestedCapital:"Invested Capital",evaCapitalCharge:"Capital Charge",horizontalTitle:"Horizontal Analysis (Trend Analysis)",horizontalDesc:"Compares financial statement items across two periods (current and previous, if available).",horizontalDataWarning:"Previous period data ('financialDataPrevious') not found. Please ensure prior period data was entered and the 'Report' page was run.",horizontalIS:"Income Statement - Period Comparison",horizontalBS:"Balance Sheet - Period Comparison",horizontalAccount:"Account",horizontalCurrentPeriod:"Current Period",horizontalPreviousPeriod:"Previous Period",horizontalChangeAbs:"Change ($)",horizontalChangePct:"Change (%)",cccTitle:"Cash Conversion Cycle (CCC)",cccDesc:"Measures the time (in days) it takes to convert inventory and resource investments into cash.",cccDataWarning:"Insufficient data for CCC (Ensure 'Report' page was run).",cccValueLabel:"Cash Conversion Cycle (Days):",cccInterpretation:"Interpretation:",cccInterpretationShort:"๐ข Short cycle: High efficiency.",cccInterpretationLong:"๐ก Long cycle: Slowness in selling inventory or collecting.",cccComponents:"Calculation Components (Days):",cccDSO:"Days Sales Outstanding (DSO)",cccDIO:"Days Inventory Outstanding (DIO)",cccDPO:"Days Payables Outstanding (DPO)",scenarioTitle:"Scenario Analysis (on Break-even)",scenarioDesc:"Test the impact of changing assumptions on the break-even point.",scenarioInputs:"Change Assumptions (%):",scenarioFixedCostsLabel:"Fixed Costs",scenarioVariableCostLabel:"Variable Cost/Unit",scenarioSellingPriceLabel:"Selling Price/Unit",scenarioRunBtn:"Run Scenario",scenarioResults:"Results:",scenarioBaseCaseInfo:"Base values are taken from the Break-even Analysis tab.",scenarioMetric:"Metric",scenarioBaseValue:"Base Value",scenarioNewValue:"New Value",scenarioChange:"Change (%)",externalInputsTitle:"Additional Valuation Inputs",labelNumShares:"Number of Shares Outstanding",labelMarketPrice:"Market Price Per Share",labelTotalDividends:"Total Annual Dividends Paid",btnUpdateValuation:"Update Valuation Ratios",exportPdf:"Export PDF"}};window.pageTranslations=window.pageTranslations||{},window.pageTranslations.ar={...window.pageTranslations.ar||{},...advancedTranslations.ar||{}},window.pageTranslations.en={...window.pageTranslations.en||{},...advancedTranslations.en||{}},document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{console.log("[DEBUG] Starting advanced-app.js initialization after delay...");const e={statementsCurrent:null,statementsPrevious:null,ratios:{},breakevenChart:null,baseBreakeven:{units:NaN,value:NaN},hasValidData:!1,hasPreviousData:!1},t=localStorage.getItem("lang")||"ar",a=e=>window.pageTranslations[t]?.[e]||`[${e}]`,n={smartSummary:document.getElementById("smartSummary"),alertsArea:document.getElementById("alertsArea"),fixedCosts:document.getElementById("fixedCosts"),variableCost:document.getElementById("variableCost"),sellingPrice:document.getElementById("sellingPrice"),calculateBreakeven:document.getElementById("calculateBreakeven"),breakevenResults:document.getElementById("breakevenResults"),bepUnitsResult:document.getElementById("bepUnitsResult"),bepValueResult:document.getElementById("bepValueResult"),breakevenChartCanvas:document.getElementById("breakevenChart"),dupontResultsContainer:document.getElementById("dupontResultsContainer"),dupontDataWarning:document.getElementById("dupontDataWarning"),dupontFormulaDisplay:document.getElementById("dupontFormulaDisplay"),dupontROE:document.getElementById("dupontROE"),dupontNPM:document.getElementById("dupontNPM"),dupontAT:document.getElementById("dupontAT"),dupontEM:document.getElementById("dupontEM"),dupontValueNPM:document.getElementById("dupontValueNPM"),dupontValueAT:document.getElementById("dupontValueAT"),dupontValueEM:document.getElementById("dupontValueEM"),dupontValueROE:document.getElementById("dupontValueROE"),dupontInterpretation:document.getElementById("dupontInterpretation"),verticalDataWarning:document.getElementById("verticalDataWarning"),verticalResultsContainer:document.getElementById("verticalResultsContainer"),verticalBSTable:document.getElementById("verticalBSTable"),verticalISTable:document.getElementById("verticalISTable"),verticalInterpretation:document.getElementById("verticalInterpretation"),verticalInterpretationList:document.getElementById("verticalInterpretationList"),zscoreDataWarning:document.getElementById("zscoreDataWarning"),zscoreResultsContainer:document.getElementById("zscoreResultsContainer"),zscoreValue:document.getElementById("zscoreValue"),zscoreInterpretation:document.getElementById("zscoreInterpretation"),zscoreFactorsList:document.getElementById("zscoreFactorsList"),cfDataWarning:document.getElementById("cfDataWarning"),cfResultsContainer:document.getElementById("cfResultsContainer"),cfStatementTableBody:document.getElementById("cfStatementTableBody"),cfValueOCFRatio:document.getElementById("cfValueOCFRatio"),cfValueFCF:document.getElementById("cfValueFCF"),cfInterpretation:document.getElementById("cfInterpretation"),waccInput:document.getElementById("waccInput"),taxRateInput:document.getElementById("taxRateInput"),calculateEVA:document.getElementById("calculateEVA"),evaDataWarning:document.getElementById("evaDataWarning"),evaResultsContainer:document.getElementById("evaResultsContainer"),evaValue:document.getElementById("evaValue"),evaInterpretation:document.getElementById("evaInterpretation"),evaValueNOPAT:document.getElementById("evaValueNOPAT"),evaValueInvestedCapital:document.getElementById("evaValueInvestedCapital"),evaValueCapitalCharge:document.getElementById("evaValueCapitalCharge"),horizontalDataWarning:document.getElementById("horizontalDataWarning"),horizontalResultsContainer:document.getElementById("horizontalResultsContainer"),horizontalISTable:document.getElementById("horizontalISTable"),horizontalBSTable:document.getElementById("horizontalBSTable"),cccDataWarning:document.getElementById("cccDataWarning"),cccResultsContainer:document.getElementById("cccResultsContainer"),cccValue:document.getElementById("cccValue"),cccInterpretation:document.getElementById("cccInterpretation"),cccValueDSO:document.getElementById("cccValueDSO"),cccValueDIO:document.getElementById("cccValueDIO"),cccValueDPO:document.getElementById("cccValueDPO"),scenarioFixedCostsChange:document.getElementById("scenarioFixedCostsChange"),scenarioVariableCostChange:document.getElementById("scenarioVariableCostChange"),scenarioSellingPriceChange:document.getElementById("scenarioSellingPriceChange"),runScenario:document.getElementById("runScenario"),scenarioBaseCaseInfo:document.getElementById("scenarioBaseCaseInfo"),scenarioBaseBEPUnits:document.getElementById("scenarioBaseBEPUnits"),scenarioNewBEPUnits:document.getElementById("scenarioNewBEPUnits"),scenarioChangeBEPUnits:document.getElementById("scenarioChangeBEPUnits"),scenarioBaseBEPValue:document.getElementById("scenarioBaseBEPValue"),scenarioNewBEPValue:document.getElementById("scenarioNewBEPValue"),scenarioChangeBEPValue:document.getElementById("scenarioChangeBEPValue"),externalNumShares:document.getElementById("externalNumShares"),externalMarketPrice:document.getElementById("externalMarketPrice"),externalTotalDividends:document.getElementById("externalTotalDividends"),updateValuationRatios:document.getElementById("updateValuationRatios")},o=e=>parseFloat(String(e||"").replace(/,/g,""))||0,i=(e,t=1)=>isFinite(e)&&!isNaN(e)?`${(100*e).toFixed(t)}%`:"N/A",r=(e,t=2)=>isFinite(e)&&!isNaN(e)?e.toFixed(t):"N/A",s=(e,t=0)=>isFinite(e)&&!isNaN(e)?e.toLocaleString(void 0,{minimumFractionDigits:t,maximumFractionDigits:t}):"N/A",l=(e,t)=>{if("number"!=typeof e||"number"!=typeof t)return"N/A";if(0===t)return e>0?"New":0===e?"0.0%":"N/A";const a=(e-t)/Math.abs(t);return(a>0?"+":"")+(100*a).toFixed(1)+"%"},c=()=>{if(e.ratios={},!e.hasValidData)return console.warn("Ratios skipped: No valid processed data."),!1;const t=e.statementsCurrent.totals,a=e.statementsPrevious?.totals||{};try{const i=t.totalAssets||0,r=t.totalEquity||0,s=t.totalLiabilities||0,l=t.totalRevenue||0,c=t.netProfit||0,u=t.totalCogs||0,d=t.purchases||0,m=t.ebit||0,p=t.workingCapital||0,g=t.retainedEarnings||0,v=t.totalInterest||0,C=t.inventory||0,h=t.accountsReceivable||0,y=t.accountsPayable||0,b=t.totalCurrentAssets||0,f=t.totalCurrentLiabilities||0,E=t.cashEquivalents||0,_=t.grossProfit||0,R=t.depreciationTotal||0,P=e.hasPreviousData?(i+(a.totalAssets||0))/2:i,I=e.hasPreviousData?(r+(a.totalEquity||0))/2:r,D=e.hasPreviousData?(C+(a.inventory||0))/2:C,B=e.hasPreviousData?(h+(a.accountsReceivable||0))/2:h,T=e.hasPreviousData?(y+(a.accountsPayable||0))/2:y,x=0!==i?p/i:1/0,V=0!==i?g/i:1/0,A=0!==i?m/i:1/0,w=0!==s?r/s:1/0,F=0!==i?l/i:0,S=isFinite(x)&&isFinite(V)&&isFinite(A)&&isFinite(w)&&isFinite(F)?.717*x+.847*V+3.107*A+.42*w+.998*F:NaN,k=0!==f?b/f:1/0,z=0!==f?(b-C)/f:1/0,N=p,L=0!==f?E/f:1/0,M=D>0&&u>0?u/D:1/0,O=P>0?l/P:0,W=B>0?l/B:1/0,$=isFinite(W)&&0!==W?365/W:1/0,q=isFinite(M)&&0!==M?365/M:1/0,U=d>0?d:u,G=T>0&&U>0?T/U*365:1/0,H=isFinite($)&&isFinite(q)&&isFinite(G)?$+q-G:1/0,X=P>0?s/P:1/0,Z=I>0?s/I:1/0,Y=0!==v?m/v:1/0,j=0!==I&&0!==P?P/I:1/0,J=0!==l?_/l:0,K=0!==l?c/l:0,Q=P>0?c/P:0,ee=I>0?c/I:0,te={numberOfShares:o(n.externalNumShares?.value),marketPricePerShare:o(n.externalMarketPrice?.value),totalDividends:o(n.externalTotalDividends?.value)},ae=te.numberOfShares>0?c/te.numberOfShares:NaN,ne=te.numberOfShares>0?r/te.numberOfShares:NaN,oe=te.numberOfShares>0?te.totalDividends/te.numberOfShares:NaN,ie=isFinite(ae)&&0!==ae&&te.marketPricePerShare>0?te.marketPricePerShare/ae:NaN,re=isFinite(ne)&&0!==ne&&te.marketPricePerShare>0?te.marketPricePerShare/ne:NaN,se=te.marketPricePerShare>0?oe/te.marketPricePerShare:NaN,le=c>0?te.totalDividends/c:NaN,ce=c+R,ue=R,de=ce-ue;return e.ratios={currentRatio:k,quickRatio:z,netWorkingCapital:N,cashRatio:L,inventoryTurnover:M,assetTurnover:O,receivablesTurnover:W,avgCollectionPeriod:$,daysInventoryOutstanding:q,daysPayablesOutstanding:G,cashConversionCycle:H,debtToAssets:X,debtToEquity:Z,interestCoverageRatio:Y,financialLeverage:j,grossProfitMargin:J,netProfitMargin:K,roa:Q,roe:ee,eps:ae,peRatio:ie,pbRatio:re,dividendYield:se,payoutRatio:le,zScoreX1:x,zScoreX2:V,zScoreX3:A,zScoreX4:w,zScoreX5:F,zScore:S,equityMultiplier:j,operatingCashFlowRatio:0!==f?ce/f:1/0,freeCashFlow:de,_netProfit:c,_ebit:m,_assets:i,_equity:r,_revenue:l,_liabilities:s,_ocf_estimated:ce,_capex_estimated:ue,_depreciation:R},localStorage.setItem("calculatedRatios",JSON.stringify(e.ratios)),console.log("Calculated Ratios (from processed data):",e.ratios),!0}catch(t){return console.error("Error calculating ratios:",t),e.ratios={},e.hasValidData=!1,!1}},u=(n,o,l)=>{const c=document.getElementById(n);if(!c)return void console.error(`Element not found: ${n}`);if(!e.hasValidData)return void(c.innerHTML=`<h5 class="mb-3">${a(o)}</h5> <p class="text-muted">${a("noDataForRatios")}</p>`);let u=`<h5 class="mb-3">${a(o)}</h5> <div class="table-responsive"> <table class="table table-sm table-striped"> <thead><tr><th>${a("thRatio")}</th><th class="text-end">${a("thValue")}</th><th>${a("thComment")}</th></tr></thead> <tbody>`;l.forEach((n=>{const o=e.ratios[n];let l;l="netWorkingCapital"===n?s(o,0):["avgCollectionPeriod","daysInventoryOutstanding","daysPayablesOutstanding","cashConversionCycle"].includes(n)?`${r(o,0)} ${"ar"===t?"ููู":"Days"}`:["grossProfitMargin","netProfitMargin","roa","roe","dividendYield","payoutRatio"].includes(n)?i(o):r(o,2),isNaN(o)&&(l="N/A");const c=((e,t)=>!isFinite(t)&&isNaN(t)?"N/A":isNaN(t)&&["eps","peRatio","pbRatio","dividendYield","payoutRatio"].includes(e)?`<span class='text-warning small fst-italic'>${a("externalDataWarning")}</span>`:"currentRatio"===e?a(t>=2?"currentRatio_comment_high":t>=1?"currentRatio_comment_good":"currentRatio_comment_low"):"quickRatio"===e?a(t>=1?"quickRatio_comment_good":"quickRatio_comment_low"):"netWorkingCapital"===e?a(t>0?"netWorkingCapital_comment_positive":"netWorkingCapital_comment_negative"):"cashRatio"===e?a(t>=.4?"cashRatio_comment_good":"cashRatio_comment_low"):"inventoryTurnover"===e?a(t>=8?"inventoryTurnover_comment_high":"inventoryTurnover_comment_low"):"assetTurnover"===e?a(t>=1?"assetTurnover_comment_high":"assetTurnover_comment_low"):"receivablesTurnover"===e?a(t>=10?"receivablesTurnover_comment_high":"receivablesTurnover_comment_low"):"avgCollectionPeriod"===e?a(t<=45?"avgCollectionPeriod_comment_low":"avgCollectionPeriod_comment_high"):"debtToEquity"===e?a(t<.5?"debtToEquity_comment_low":t<=1.5?"debtToEquity_comment_good":"debtToEquity_comment_high"):"debtToAssets"===e?a(t<.4?"debtToAssets_comment_low":"debtToAssets_comment_high"):"interestCoverageRatio"===e?a(t>=3?"interestCoverageRatio_comment_safe":"interestCoverageRatio_comment_risk"):"financialLeverage"===e?a(t>2.5?"financialLeverage_comment_high":"financialLeverage_comment_low"):"netProfitMargin"===e?a(t>=.15?"netProfitMargin_comment_high":t>0?"netProfitMargin_comment_avg":"netProfitMargin_comment_low"):"grossProfitMargin"===e?a(t>=.4?"grossProfitMargin_comment_high":"grossProfitMargin_comment_low"):"roa"===e?a(t>=.05?"roa_comment_high":"roa_comment_low"):"roe"===e?a(t>=.15?"roe_comment_high":"roe_comment_low"):"eps"===e?a(t>0?"eps_comment_positive":"eps_comment_negative"):"peRatio"===e?a("peRatio_comment"):"pbRatio"===e?a("pbRatio_comment"):"dividendYield"===e?a("dividendYield_comment"):"payoutRatio"===e?a("payoutRatio_comment"):"")(n,o);u+=`<tr> <td>${a(n)}</td> <td class="text-end"><strong>${l}</strong></td> <td class="text-muted small">${c}</td> </tr>`})),c.innerHTML=u+"</tbody></table></div>"},d=()=>{const t=o(n.fixedCosts.value),i=o(n.variableCost.value),r=o(n.sellingPrice.value);if(r<=0||i<0||t<0)return alert(a("errorPositiveValues")),{units:NaN,value:NaN};if(r<=i)return alert(a("errorPrice")),{units:NaN,value:NaN};const l=t/(r-i),c=l*r;return n.bepUnitsResult.textContent=Math.ceil(l).toLocaleString(),n.bepValueResult.textContent=s(c,2),n.breakevenResults.style.display="block",m(t,i,r,l),e.baseBreakeven={units:l,value:c},e.baseBreakeven},m=(t,o,i,r)=>{if(!n.breakevenChartCanvas)return;e.breakevenChart&&e.breakevenChart.destroy();let s=100;r>0&&isFinite(r)?s=Math.max(100,10*Math.ceil(2*r/10)):(0===t&&i>o||i<=o)&&(s=100);const l=s/10,c=Array.from({length:11},((e,t)=>Math.round(l*t))),u=c.map((()=>t)),d=c.map((e=>t+o*e)),m=c.map((e=>i*e)),p=n.breakevenChartCanvas.getContext("2d");e.breakevenChart=new Chart(p,{type:"line",data:{labels:c,datasets:[{label:a("revenue"),data:m,borderColor:"rgba(75, 192, 192, 1)",fill:!1,tension:.1},{label:a("totalCosts"),data:d,borderColor:"rgba(255, 99, 132, 1)",fill:!1,tension:.1},{label:a("fixedCosts"),data:u,borderColor:"rgba(255, 159, 64, 1)",borderDash:[5,5],fill:!1,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},scales:{x:{title:{display:!0,text:a("unitsSold")}},y:{title:{display:!0,text:a("value")},beginAtZero:!0}},plugins:{tooltip:{callbacks:{label:function(e){return`${e.dataset.label}: ${e.parsed.y.toLocaleString()}`}}}}}})},p=()=>{if(console.log("[DEBUG] Attempting to calculate and display DuPont..."),!e.hasValidData||!isFinite(e.ratios.equityMultiplier))return console.warn("[DEBUG] No valid data for DuPont, showing warning."),n.dupontDataWarning&&(n.dupontDataWarning.textContent=a("dupontDataWarning"),n.dupontDataWarning.style.display="block"),n.dupontFormulaDisplay&&(n.dupontFormulaDisplay.style.display="none"),n.dupontInterpretation&&(n.dupontInterpretation.innerHTML=""),n.dupontValueNPM&&(n.dupontValueNPM.textContent="N/A"),n.dupontValueAT&&(n.dupontValueAT.textContent="N/A"),n.dupontValueEM&&(n.dupontValueEM.textContent="N/A"),void(n.dupontValueROE&&(n.dupontValueROE.textContent="N/A"));console.log("[DEBUG] Rendering DuPont with data..."),n.dupontDataWarning&&(n.dupontDataWarning.style.display="none"),n.dupontFormulaDisplay&&(n.dupontFormulaDisplay.style.display="block");const o=e.ratios.netProfitMargin,s=e.ratios.assetTurnover,l=e.ratios.equityMultiplier,c=isFinite(o)&&isFinite(s)&&isFinite(l)?o*s*l:1/0;n.dupontROE&&(n.dupontROE.textContent=i(c)),n.dupontNPM&&(n.dupontNPM.textContent=i(o)),n.dupontAT&&(n.dupontAT.textContent=r(s)),n.dupontEM&&(n.dupontEM.textContent=r(l)),n.dupontValueNPM&&(n.dupontValueNPM.textContent=i(o)),n.dupontValueAT&&(n.dupontValueAT.textContent=r(s)),n.dupontValueEM&&(n.dupontValueEM.textContent=r(l)),n.dupontValueROE&&(n.dupontValueROE.textContent=i(c));let u="";if(isFinite(c)){u+=c>=.15?`<p>${a("dupontInterpretationHighROE")}</p><ul>`:`<p>${a("dupontInterpretationLowROE")}</p><ul>`,isFinite(o)&&(o>=.1?u+=`<li>${a("dupontFactorProfitability")}</li>`:o<.05&&(u+=`<li>${a("dupontFactorLowProfitability")}</li>`)),isFinite(s)&&(s>=1?u+=`<li>${a("dupontFactorEfficiency")}</li>`:s<.5&&(u+=`<li>${a("dupontFactorLowEfficiency")}</li>`)),isFinite(l)&&(l>2.5?u+=`<li>${a("dupontFactorLeverage")}</li>`:l<1.5&&(u+=`<li>${a("dupontFactorLowLeverage")}</li>`)),u+="</ul>",u.endsWith("<ul></ul>")&&(u=`<p>${"ar"===t?"ุงูุนูุงูู ูุชูุงุฒูุฉ.":"Factors appear balanced."}</p>`)}else u=`<p class="text-danger">${"ar"===t?"ูุง ูููู ุญุณุงุจ ุงูุชูุณูุฑ.":"Interpretation cannot be calculated."}</p>`;n.dupontInterpretation&&(n.dupontInterpretation.innerHTML=u),console.log("[DEBUG] Finished displaying DuPont.")},g=()=>{if(!(e.hasValidData&&e.statementsCurrent&&e.statementsCurrent.bs&&e.statementsCurrent.is))return n.verticalDataWarning&&(n.verticalDataWarning.textContent=a("verticalDataWarning"),n.verticalDataWarning.style.display="block"),n.verticalResultsContainer&&(n.verticalResultsContainer.style.display="none"),void(n.verticalInterpretation&&(n.verticalInterpretation.style.display="none"));n.verticalDataWarning&&(n.verticalDataWarning.style.display="none"),n.verticalResultsContainer&&(n.verticalResultsContainer.style.display="block"),n.verticalInterpretation&&(n.verticalInterpretation.style.display="block");const t=e.statementsCurrent.totals.totalAssets||0,o=e.statementsCurrent.totals.totalRevenue||0,r=(e.statementsCurrent.totals.totalLiabilities||0)+(e.statementsCurrent.totals.totalEquity||0);let l=`<table class="table table-sm table-striped"><thead><tr><th>${a("verticalAccount")}</th><th class="text-end">${a("verticalValue")}</th><th class="text-end">${a("verticalPercent")}</th></tr></thead><tbody>`;const c=[...e.statementsCurrent.bs.currentAssets,...e.statementsCurrent.bs.nonCurrentAssets,...e.statementsCurrent.bs.currentLiabilities,...e.statementsCurrent.bs.nonCurrentLiabilities,...e.statementsCurrent.bs.equityCapital,{account:a("retainedEarnings"),value:e.statementsCurrent.totals.retainedEarnings||0}];var u;((u=c)?[...u].sort(((e,t)=>Math.abs(t.value||0)-Math.abs(e.value||0))):[]).forEach((e=>{const a=0!==t?(e.value||0)/t:0,n=Math.abs(e.value||0);l+=`<tr><td>${e.account}</td><td class="text-end">${s(n)}</td><td class="text-end">${i(Math.abs(a))}</td></tr>`})),l+=`<tr class="table-light fw-bold"><td>${a("totalAssets")}</td><td class="text-end">${s(t)}</td><td class="text-end">100.0%</td></tr>`,l+="</tbody></table>",n.verticalBSTable&&(n.verticalBSTable.innerHTML=l);let d=`<table class="table table-sm table-striped"><thead><tr><th>${a("verticalAccount")}</th><th class="text-end">${a("verticalValue")}</th><th class="text-end">${a("verticalPercent")}</th></tr></thead><tbody>`;const m=[...e.statementsCurrent.is.revenue,...e.statementsCurrent.is.cogs,...e.statementsCurrent.is.genAdminExpenses,...e.statementsCurrent.is.sellingMarketingExpenses,...e.statementsCurrent.is.depreciationAmortization,...e.statementsCurrent.is.otherOperatingExpenses,...e.statementsCurrent.is.interestExpense,...e.statementsCurrent.is.taxExpense].sort(((t,a)=>{const n=e.statementsCurrent.is.revenue.some((e=>e.account===t.account)),o=e.statementsCurrent.is.revenue.some((e=>e.account===a.account));return n?-1:o?1:Math.abs(a.value||0)-Math.abs(t.value||0)}));m.forEach((e=>{const t=e.value||0,a=0!==o?t/o:0,n=Math.abs(t);d+=`<tr><td>${e.account}</td><td class="text-end">${s(n)}</td><td class="text-end">${i(Math.abs(a))}</td></tr>`})),d+=`<tr class="table-light fw-bold"><td>${a("netProfit")}</td><td class="text-end">${s(e.statementsCurrent.totals.netProfit||0,2)}</td><td class="text-end">${i((e.statementsCurrent.totals.netProfit||0)/o)}</td></tr>`,d+="</tbody></table>",n.verticalISTable&&(n.verticalISTable.innerHTML=d);let p="";const g=[],v=[...c].sort(((e,t)=>Math.abs(t.value||0)-Math.abs(e.value||0))).find((t=>e.statementsCurrent.bs.currentAssets.includes(t)||e.statementsCurrent.bs.nonCurrentAssets.includes(t)));if(v&&0!==t){const e=(v.value||0)/t;g.push(a("verticalLargestAsset").replace("{account}",v.account).replace("{percent}",i(e)))}const C=[...e.statementsCurrent.bs.currentLiabilities,...e.statementsCurrent.bs.nonCurrentLiabilities].sort(((e,t)=>t.value-e.value))[0];if(C&&0!==r){const e=Math.abs(C.value||0)/r;g.push(a("verticalLargestLiability").replace("{account}",C.account).replace("{percent}",i(e)))}const h=e.statementsCurrent.bs.equityCapital.sort(((e,t)=>t.value-e.value))[0];if(h&&0!==r){const e=Math.abs(h.value||0)/r;g.push(a("verticalLargestEquity").replace("{account}",h.account).replace("{percent}",i(e)))}if(0!==o){const t=(e.statementsCurrent.totals.grossProfit||0)/o;g.push(a("verticalGrossMarginComment").replace("{percent}",i(t)))}const y=m.find((t=>t.value>0&&!e.statementsCurrent.is.cogs.find((e=>e.account===t.account))));if(y&&0!==o){const e=Math.abs(y.value||0)/o;g.push(a("verticalLargestExpense").replace("{account}",y.account).replace("{percent}",i(e)))}g.forEach((e=>{p+=`<li>${e}</li>`})),n.verticalInterpretationList&&(n.verticalInterpretationList.innerHTML=p)},v=()=>{if(!e.hasValidData||!isFinite(e.ratios.zScore))return n.zscoreDataWarning&&(n.zscoreDataWarning.textContent=a("zscoreDataWarning"),n.zscoreDataWarning.style.display="block"),void(n.zscoreResultsContainer&&(n.zscoreResultsContainer.style.display="none"));n.zscoreDataWarning&&(n.zscoreDataWarning.style.display="none"),n.zscoreResultsContainer&&(n.zscoreResultsContainer.style.display="block");const t=e.ratios.zScore;let o="",i="";t>2.9?(o=a("zscoreZoneSafe"),i="text-success"):t>1.23?(o=a("zscoreZoneGrey"),i="text-warning"):(o=a("zscoreZoneDistress"),i="text-danger"),n.zscoreValue&&(n.zscoreValue.textContent=r(t,3)),n.zscoreInterpretation&&(n.zscoreInterpretation.textContent=o,n.zscoreInterpretation.className=`h5 fw-bold ${i}`);let s="";["zScoreX1","zScoreX2","zScoreX3","zScoreX4","zScoreX5"].forEach((t=>{const n=e.ratios[t];let o=a(t.replace("zScore","zscore"));"zScoreX2"!==t||0!==(e.ratios._retainedEarnings||0)||isFinite(n)||(o+=` <small class="text-muted">${a("zscoreRetainedEarningsNotFound")}</small>`),s+=`<li class="list-group-item d-flex justify-content-between align-items-center">${o} <span class="badge bg-secondary rounded-pill">${r(n)}</span></li>`})),n.zscoreFactorsList&&(n.zscoreFactorsList.innerHTML=s)},C=()=>{if(!e.hasValidData)return n.cfDataWarning&&(n.cfDataWarning.textContent=a("cfDataWarning"),n.cfDataWarning.style.display="block"),void(n.cfResultsContainer&&(n.cfResultsContainer.style.display="none"));n.cfDataWarning&&(n.cfDataWarning.style.display="none"),n.cfResultsContainer&&(n.cfResultsContainer.style.display="block");const t=e.ratios;let o=` <tr><td>${a("netIncomeForCF")}</td><td class="text-end">${s(t._netProfit)}</td></tr> <tr><td class="ps-3">${a("depreciationAmortizationForCF")}</td><td class="text-end">${s(t._depreciation||0)}</td></tr> <tr><td class="text-muted ps-3">${a("changesInWorkingCapital")}</td><td class="text-end text-muted">(N/A)</td></tr> <tr class="table-light fw-bold"><td>${a("cashFlowFromOperations")}</td><td class="text-end">${s(t._ocf_estimated)}</td></tr> <tr><td>${a("capitalExpenditures")}</td><td class="text-end">${s(t._capex_estimated)}</td></tr> <tr class="table-light fw-bold"><td>${a("cfRatioFCF")}</td><td class="text-end">${s(t.freeCashFlow)}</td></tr>`;n.cfStatementTableBody&&(n.cfStatementTableBody.innerHTML=o),n.cfValueOCFRatio&&(n.cfValueOCFRatio.textContent=r(t.operatingCashFlowRatio)),n.cfValueFCF&&(n.cfValueFCF.textContent=s(t.freeCashFlow));let i="";isFinite(t._ocf_estimated)&&(i+=t._ocf_estimated>0?`<p>${a("cfInterpretationPositiveOCF")}</p>`:`<p>${a("cfInterpretationNegativeOCF")}</p>`),isFinite(t.freeCashFlow)&&(i+=`<p>${a("cfInterpretationFCF")}</p>`),n.cfInterpretation&&(n.cfInterpretation.innerHTML=i||'<p class="text-muted">...</p>')},h=()=>{if(console.log("[DEBUG] Attempting to calculate and display EVA..."),!e.hasValidData||!isFinite(e.ratios._ebit))return console.warn("[DEBUG] No valid data for EVA, showing warning."),n.evaDataWarning&&(n.evaDataWarning.textContent=a("evaDataWarning"),n.evaDataWarning.style.display="block"),void(n.evaResultsContainer&&(n.evaResultsContainer.style.display="none"));n.evaDataWarning&&(n.evaDataWarning.style.display="none"),n.evaResultsContainer&&(n.evaResultsContainer.style.display="block");const t=e.statementsCurrent.totals,i=o(n.waccInput.value)/100,r=o(n.taxRateInput.value)/100;if(i<=0||r<0)return void alert(a("errorPositiveValues"));const l=(t.ebit||0)*(1-r),c=(t.totalCurrentLiabilities||0)-(t.shortTermDebt||0),u=(t.totalAssets||0)-c,d=u*i,m=l-d;n.evaValue&&(n.evaValue.textContent=s(m,0)),n.evaValueNOPAT&&(n.evaValueNOPAT.textContent=s(l,0)),n.evaValueInvestedCapital&&(n.evaValueInvestedCapital.textContent=s(u,0)),n.evaValueCapitalCharge&&(n.evaValueCapitalCharge.textContent=s(d,0)),n.evaInterpretation&&(m>0?(n.evaInterpretation.textContent=a("evaInterpretationPositive"),n.evaInterpretation.className="h5 fw-bold text-success",n.evaValue.className="display-4 fw-bold text-success"):(n.evaInterpretation.textContent=a("evaInterpretationNegative"),n.evaInterpretation.className="h5 fw-bold text-danger",n.evaValue.className="display-4 fw-bold text-danger")),console.log("[DEBUG] Finished displaying EVA.")},y=()=>{if(console.log("[DEBUG] Attempting to display Horizontal Analysis..."),!e.hasValidData||!e.hasPreviousData)return n.horizontalDataWarning&&(n.horizontalDataWarning.textContent=a("horizontalDataWarning"),n.horizontalDataWarning.style.display="block"),n.horizontalResultsContainer&&(n.horizontalResultsContainer.style.display="none"),void console.warn("[DEBUG] Insufficient data for Horizontal Analysis.");n.horizontalDataWarning&&(n.horizontalDataWarning.style.display="none"),n.horizontalResultsContainer&&(n.horizontalResultsContainer.style.display="block");const t=(e=[],t=[])=>{let a="";Array.isArray(e)||(e=[]),Array.isArray(t)||(t=[]);const n=new Set([...e.map((e=>e.account)),...t.map((e=>e.account))]),o=new Map(t.map((e=>[e.account,e.value])));return n.forEach((t=>{const n=e.find((e=>e.account===t)),i=n?n.value:0,r=o.get(t)||0,c=i-r;a+=`<tr>\n                          <td>${t}</td>\n                          <td class="text-end">${s(i)}</td>\n                          <td class="text-end">${s(r)}</td>\n                          <td class="text-end">${s(c)}</td>\n                          <td class="text-end ${c>0?"text-success":c<0?"text-danger":""}">${l(i,r)}</td>\n                       </tr>`})),a},o=[...e.statementsCurrent.bs.currentAssets||[],...e.statementsCurrent.bs.nonCurrentAssets||[],...e.statementsCurrent.bs.currentLiabilities||[],...e.statementsCurrent.bs.nonCurrentLiabilities||[],...e.statementsCurrent.bs.equityCapital||[],{account:a("retainedEarnings"),value:e.statementsCurrent.totals.retainedEarnings||0}],i=[...e.statementsPrevious.bs.currentAssets||[],...e.statementsPrevious.bs.nonCurrentAssets||[],...e.statementsPrevious.bs.currentLiabilities||[],...e.statementsPrevious.bs.nonCurrentLiabilities||[],...e.statementsPrevious.bs.equityCapital||[],{account:a("retainedEarnings"),value:e.statementsPrevious.totals.retainedEarnings||0}];let r=`<table class="table table-sm table-striped"><thead><tr><th>${a("horizontalAccount")}</th><th class="text-end">${a("horizontalCurrentPeriod")}</th><th class="text-end">${a("horizontalPreviousPeriod")}</th><th class="text-end">${a("horizontalChangeAbs")}</th><th class="text-end">${a("horizontalChangePct")}</th></tr></thead><tbody>`;r+=t(o,i),r+="</tbody></table>",n.horizontalBSTable&&(n.horizontalBSTable.innerHTML=r);const c=[...e.statementsCurrent.is.revenue||[],...e.statementsCurrent.is.cogs||[],...e.statementsCurrent.is.genAdminExpenses||[],...e.statementsCurrent.is.sellingMarketingExpenses||[],...e.statementsCurrent.is.depreciationAmortization||[],...e.statementsCurrent.is.otherOperatingExpenses||[],...e.statementsCurrent.is.interestExpense||[],...e.statementsCurrent.is.taxExpense||[]],u=[...e.statementsPrevious.is.revenue||[],...e.statementsPrevious.is.cogs||[],...e.statementsPrevious.is.genAdminExpenses||[],...e.statementsPrevious.is.sellingMarketingExpenses||[],...e.statementsPrevious.is.depreciationAmortization||[],...e.statementsPrevious.is.otherOperatingExpenses||[],...e.statementsPrevious.is.interestExpense||[],...e.statementsPrevious.is.taxExpense||[]];let d=`<table class="table table-sm table-striped"><thead><tr><th>${a("horizontalAccount")}</th><th class="text-end">${a("horizontalCurrentPeriod")}</th><th class="text-end">${a("horizontalPreviousPeriod")}</th><th class="text-end">${a("horizontalChangeAbs")}</th><th class="text-end">${a("horizontalChangePct")}</th></tr></thead><tbody>`;d+=t(c,u),d+="</tbody></table>",n.horizontalISTable&&(n.horizontalISTable.innerHTML=d),console.log("[DEBUG] Finished displaying Horizontal Analysis.")},b=()=>{console.log("[DEBUG] Attempting to display CCC...");if(!(e.hasValidData&&e.ratios&&isFinite(e.ratios.cashConversionCycle)))return n.cccDataWarning&&(n.cccDataWarning.textContent=a("cccDataWarning"),n.cccDataWarning.style.display="block"),n.cccResultsContainer&&(n.cccResultsContainer.style.display="none"),void console.warn("[DEBUG] Insufficient data for CCC display.");n.cccDataWarning&&(n.cccDataWarning.style.display="none"),n.cccResultsContainer&&(n.cccResultsContainer.style.display="block");const t=e.ratios.cashConversionCycle,o=e.ratios.avgCollectionPeriod,i=e.ratios.daysInventoryOutstanding,s=e.ratios.daysPayablesOutstanding;n.cccValue&&(n.cccValue.textContent=r(t,0)),n.cccValueDSO&&(n.cccValueDSO.textContent=r(o,0)),n.cccValueDIO&&(n.cccValueDIO.textContent=r(i,0)),n.cccValueDPO&&(n.cccValueDPO.textContent=r(s,0)),n.cccInterpretation&&(t<=30&&isFinite(t)?(n.cccInterpretation.textContent=a("cccInterpretationShort"),n.cccInterpretation.className="h5 text-success",n.cccValue&&(n.cccValue.className="display-4 fw-bold text-success")):isFinite(t)?(n.cccInterpretation.textContent=a("cccInterpretationLong"),n.cccInterpretation.className="h5 text-warning",n.cccValue&&(n.cccValue.className="display-4 fw-bold text-warning")):(n.cccInterpretation.textContent="",n.cccValue&&(n.cccValue.className="display-4 fw-bold"))),console.log("[DEBUG] Finished displaying CCC.")},f=()=>{console.log("[DEBUG] Running Scenario Analysis...");const i=o(n.fixedCosts.value),r=o(n.variableCost.value),c=o(n.sellingPrice.value);if(isNaN(e.baseBreakeven.units)||isNaN(e.baseBreakeven.value))if(isFinite(i)&&isFinite(r)&&isFinite(c)&&c>r){const t=c-r;e.baseBreakeven.units=i/t,e.baseBreakeven.value=e.baseBreakeven.units*c,console.log("[DEBUG] Base breakeven calculated for scenario:",e.baseBreakeven)}else{const e=d();if(isNaN(e?.units))return void alert("ar"===t?"ูุฑุฌู ุฅุฏุฎุงู ููู ุตุงูุญุฉ ูุญุณุงุจ ููุทุฉ ุงูุชุนุงุฏู ุงูุฃุณุงุณูุฉ ุฃููุงู ูู ุชุจููุจ ุชุญููู ุงูุชุนุงุฏู.":"Please enter valid values and calculate the base break-even point first in the Break-even Analysis tab.")}const u=i*(1+o(n.scenarioFixedCostsChange.value)/100),m=r*(1+o(n.scenarioVariableCostChange.value)/100),p=c*(1+o(n.scenarioSellingPriceChange.value)/100);let g=NaN,v=NaN;if(p<=0||m<0||u<0)alert(a("errorPositiveValues"));else if(p<=m)alert(a("errorPrice"));else{g=u/(p-m),v=g*p}n.scenarioBaseCaseInfo&&(n.scenarioBaseCaseInfo.textContent=a("scenarioBaseCaseInfo")),n.scenarioBaseBEPUnits&&(n.scenarioBaseBEPUnits.textContent=isFinite(e.baseBreakeven.units)?Math.ceil(e.baseBreakeven.units).toLocaleString():"N/A"),n.scenarioNewBEPUnits&&(n.scenarioNewBEPUnits.textContent=isFinite(g)?Math.ceil(g).toLocaleString():"N/A"),n.scenarioChangeBEPUnits&&(n.scenarioChangeBEPUnits.textContent=l(g,e.baseBreakeven.units)),n.scenarioBaseBEPValue&&(n.scenarioBaseBEPValue.textContent=s(e.baseBreakeven.value,2)),n.scenarioNewBEPValue&&(n.scenarioNewBEPValue.textContent=s(v,2)),n.scenarioChangeBEPValue&&(n.scenarioChangeBEPValue.textContent=l(v,e.baseBreakeven.value)),console.log("[DEBUG] Finished Scenario Analysis.")},E=()=>{console.log("[DEBUG] Updating ratios with external inputs..."),c()?(u("profitabilityRatios","profitabilityRatios",["grossProfitMargin","netProfitMargin","roa","roe","eps"]),u("valuationRatios","valuationRatios",["peRatio","pbRatio","dividendYield","payoutRatio"]),console.log("[DEBUG] Profitability and Valuation tables re-rendered.")):console.error("[DEBUG] Failed to recalculate ratios after external input update.")},_=()=>(console.log("Running full analysis..."),(()=>{console.log("[DEBUG] Loading processed data from localStorage...");const t=localStorage.getItem("financialDataCurrent"),a=localStorage.getItem("financialDataPrevious");if(e.hasValidData=!1,e.hasPreviousData=!1,e.statementsCurrent=null,e.statementsPrevious=null,t)try{e.statementsCurrent=JSON.parse(t),e.statementsCurrent&&e.statementsCurrent.totals?(e.hasValidData=!0,console.log("[DEBUG] Loaded 'financialDataCurrent' successfully.")):console.warn("[DEBUG] 'financialDataCurrent' found but format is invalid.")}catch(e){console.error("Error parsing 'financialDataCurrent':",e)}else console.warn("[DEBUG] 'financialDataCurrent' not found in localStorage. Run 'Report' page first.");if(a)try{e.statementsPrevious=JSON.parse(a),e.statementsPrevious&&e.statementsPrevious.totals?(e.hasPreviousData=!0,console.log("[DEBUG] Loaded 'financialDataPrevious' successfully.")):console.warn("[DEBUG] 'financialDataPrevious' found but format is invalid.")}catch(e){console.error("Error parsing 'financialDataPrevious':",e)}else console.warn("[DEBUG] 'financialDataPrevious' not found. Comparative analysis will be limited.");return e.hasValidData})()?c()?(u("liquidityRatios","liquidityRatios",["currentRatio","quickRatio","netWorkingCapital","cashRatio"]),u("profitabilityRatios","profitabilityRatios",["grossProfitMargin","netProfitMargin","roa","roe","eps"]),u("leverageRatios","leverageRatios",["debtToAssets","debtToEquity","interestCoverageRatio","financialLeverage"]),u("efficiencyRatios","activityRatios",["inventoryTurnover","assetTurnover","receivablesTurnover","avgCollectionPeriod"]),u("valuationRatios","valuationRatios",["peRatio","pbRatio","dividendYield","payoutRatio"]),(()=>{if(!e.hasValidData)return n.smartSummary.textContent="...",void(n.alertsArea.innerHTML="<div>...</div>");const{netProfitMargin:t,currentRatio:o,debtToEquity:i}=e.ratios;n.smartSummary.textContent=a(t>0&&o>1.5?"summary_ok":"summary_risk");const r=[];o<1&&isFinite(o)&&r.push(a("alert_liquidity_risk")),i>2&&isFinite(i)&&r.push(a("alert_leverage_risk")),t<0&&isFinite(t)&&r.push(a("alert_profit_risk")),n.alertsArea.innerHTML=r.length>0?r.map((e=>`<div>${e}</div>`)).join(""):`<div>${a("alert_ok")}</div>`})(),e.hasValidData):(console.error("Failed to calculate ratios even with processed data."),!1):(console.error("Failed to load essential processed data (financialDataCurrent). Aborting analysis."),Object.values(n).forEach((e=>{e&&e.id&&["languageSelect","themeToggle"].includes(e.id)})),alert(a("noDataForAdvanced")),!1));document.getElementById("ratios-pane")&&document.getElementById("cashflow-pane")?(console.log("Initializing advanced page..."),setTimeout((()=>{console.log("[DEBUG] Running initial analysis after delay..."),"function"==typeof window.applyTranslations?(console.log("Applying translations before initial render..."),window.applyTranslations()):console.warn("applyTranslations function not found."),_()?(console.log("[DEBUG] Initial analysis successful. Rendering other tabs..."),p(),g(),v(),C(),h(),y(),b()):console.error("[DEBUG] Initial analysis FAILED. Other tabs will not be rendered."),"function"==typeof window.applyTranslations&&(console.log("Applying translations *after* initial render and all dynamic content..."),window.applyTranslations()),console.log("Advanced page initialized.")}),100),n.calculateBreakeven&&n.calculateBreakeven.addEventListener("click",d),n.calculateEVA&&n.calculateEVA.addEventListener("click",h),n.runScenario&&n.runScenario.addEventListener("click",f),n.updateValuationRatios&&n.updateValuationRatios.addEventListener("click",E),document.querySelectorAll(".export-pdf-btn").forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget.dataset.exportTarget,a=document.querySelector(t);if(!a)return console.error(`Export target '${t}' not found.`),void alert("Error: Could not find content to export.");if("function"==typeof html2pdf){const e={margin:.5,filename:`Financial_Analysis_${t.replace("-pane-content","").replace("#","")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};html2pdf().from(a).set(e).save()}else console.error("html2pdf library not loaded."),alert("PDF export failed. Library not loaded.")}))})),["ratios","breakeven","dupont","vertical","zscore","cashflow","eva","horizontal","ccc","scenario"].forEach((t=>{const a=document.getElementById(`${t}-tab`);a?a.addEventListener("shown.bs.tab",(()=>{if(console.log(`${t} tab shown`),!e.hasValidData)return console.warn(`[DEBUG] Tab ${t} shown, but no valid data exists.`),_(),"dupont"===t&&p(),"vertical"===t&&g(),"zscore"===t&&v(),"cashflow"===t&&C(),"eva"===t&&h(),"horizontal"===t&&y(),void("ccc"===t&&b());"breakeven"===t&&e.breakevenChart&&e.breakevenChart.resize(),"dupont"===t&&p(),"vertical"===t&&g(),"zscore"===t&&v(),"cashflow"===t&&C(),"eva"===t&&h(),"horizontal"===t&&y(),"ccc"===t&&b()})):console.warn(`Tab button not found for ID: ${t}-tab`)}))):console.error("One or more critical tab pane elements were not found. Initialization stopped.")}),0)}));

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Statements</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
<header>
<h1>Financial Statements Generator</h1>
<nav>
  <a href="index.html">Data Entry</a> |
  <a href="analysis.html">Analysis</a> |
  <a href="dashboard.html">Dashboard</a>
</nav>
</header>
<main>
<section class="statements-section">
<h2>Generated Financial Statements</h2>
<div id="statementsContainer"></div>
<button onclick="exportStatementsCSV()">Export Statements CSV</button>
</section>
</main>
<script src="script.js"></script>
<script>
window.onload = function() {
  loadData();
  generateStatements();
};

function generateStatements(){
  const container=document.getElementById('statementsContainer');
  container.innerHTML='';
  financialData.forEach(d=>{
    container.innerHTML+=`
      <h3>${d.companyName}</h3>
      <table border="1" cellspacing="0" cellpadding="5">
        <tr><th colspan="2">Balance Sheet</th></tr>
        <tr><td>Total Assets</td><td>${formatNumber(d.totalAssets)}</td></tr>
        <tr><td>Total Liabilities</td><td>${formatNumber(d.totalLiabilities)}</td></tr>
        <tr><td>Equity</td><td>${formatNumber(d.equity)}</td></tr>
        <tr><th colspan="2">Income Statement</th></tr>
        <tr><td>Revenue</td><td>${formatNumber(d.revenue)}</td></tr>
        <tr><td>COGS</td><td>${formatNumber(d.cogs)}</td></tr>
        <tr><td>Operating Expenses</td><td>${formatNumber(d.opExpenses)}</td></tr>
        <tr><td>Net Income</td><td>${formatNumber(d.netIncome)}</td></tr>
        <tr><th colspan="2">Cash Flow Statement</th></tr>
        <tr><td>Operating CF</td><td>${formatNumber(d.opCF)}</td></tr>
        <tr><td>Investing CF</td><td>${formatNumber(d.invCF)}</td></tr>
        <tr><td>Financing CF</td><td>${formatNumber(d.finCF)}</td></tr>
        <tr><td>Free CF</td><td>${formatNumber(d.freeCF)}</td></tr>
      </table><br/>
    `;
  });
}

function exportStatementsCSV(){
  if(!financialData.length){alert('No data'); return;}
  let csv='Company,Total Assets,Total Liabilities,Equity,Revenue,COGS,OpExpenses,NetIncome,OpCF,InvCF,FinCF,FreeCF\n';
  financialData.forEach(d=>{
    csv+=`${d.companyName},${d.totalAssets},${d.totalLiabilities},${d.equity},${d.revenue},${d.cogs},${d.opExpenses},${d.netIncome},${d.opCF},${d.invCF},${d.finCF},${d.freeCF}\n`;
  });
  const blob=new Blob([csv],{type:'text/csv'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='financial_statements.csv';
  a.click();
}
</script>
</body>
</html>

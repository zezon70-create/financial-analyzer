<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>التحليلات المالية الفائقة + التنبؤات 10 سنوات | Financial Analyzer</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; transition: background 0.3s, color 0.3s;}
.light-mode { background: #f8f9fa; color: #212529;}
.dark-mode { background: #121212; color: #f8f9fa;}
header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#0d6efd; color:#fff;}
header .logo { height:40px; margin-left:10px;}
header button, header select { margin-left:10px; padding:5px 10px; cursor:pointer; }
.container { padding:20px;}
.card { background:#fff; border-radius:8px; padding:15px; margin-bottom:20px; box-shadow:0 2px 6px rgba(0,0,0,0.2);}
.dark-mode .card { background:#1e1e1e;}
.card-header { font-weight:bold; margin-bottom:10px; padding:10px; border-radius:6px;}
.bg-primary { background:#0d6efd; color:#fff;}
.bg-success { background:#198754; color:#fff;}
.bg-warning { background:#ffc107; color:#212529;}
.bg-danger { background:#dc3545; color:#fff;}
table { width:100%; border-collapse:collapse;}
table, th, td { border:1px solid #dee2e6;}
th, td { padding:8px; text-align:right;}
th { background:#e9ecef;}
.dark-mode th { background:#2c2c2c;}
canvas { width:100% !important; max-height:250px;}
.footer { text-align:center; padding:10px; background:#e9ecef; margin-top:20px;}
.dark-mode .footer { background:#1e1e1e; color:#f8f9fa;}
.alert { padding:10px; margin-bottom:15px; border-radius:6px;}
.alert-success { background:#d1e7dd; color:#0f5132;}
.alert-warning { background:#fff3cd; color:#664d03;}
.alert-danger { background:#f8d7da; color:#842029;}
</style>
</head>
<body class="light-mode">

<header>
  <div class="d-flex align-items-center">
    <img src="assets/logo.png" alt="logo" class="logo">
    <strong id="siteTitle">Financial Analyzer</strong>
  </div>
  <div>
    <select id="currencySelect">
      <option value="EGP">جنيه</option>
      <option value="USD">USD</option>
      <option value="EUR">EUR</option>
    </select>
    <button id="toggleDarkMode">Dark/Light</button>
    <button id="toggleLanguage">EN/AR</button>
  </div>
</header>

<div class="container">
  <h1 id="pageTitle">📊 التحليلات المالية الفائقة + تنبؤ 10 سنوات</h1>
  <p id="pageDesc">جميع النسب والمؤشرات مع مقارنة بين الفترة السابقة والحالية + التنبؤات المستقبلية والمخاطر حسب السيناريوهات.</p>

  <div class="alert alert-warning" id="forecastAlert">
    تشمل التنبؤات المستقبلية لعوائد ومخاطر الشركة لكل سنة لعشر سنوات.
  </div>

  <div class="row">
    <div class="col">
      <div class="card">
        <div class="card-header bg-primary" id="liquidityHeader">نسب السيولة</div>
        <table>
          <thead><tr><th>النسبة</th><th>الفترة السابقة</th><th>الفترة الحالية</th><th>10 سنوات تنبؤ</th><th>التفسير</th></tr></thead>
          <tbody id="liquidityRatios"></tbody>
        </table>
      </div>
    </div>
    <div class="col">
      <div class="card">
        <div class="card-header bg-success" id="profitabilityHeader">نسب الربحية</div>
        <table>
          <thead><tr><th>النسبة</th><th>الفترة السابقة</th><th>الفترة الحالية</th><th>10 سنوات تنبؤ</th><th>التفسير</th></tr></thead>
          <tbody id="profitabilityRatios"></tbody>
        </table>
      </div>
    </div>
    <div class="col">
      <div class="card">
        <div class="card-header bg-warning" id="activityHeader">نسب النشاط</div>
        <table>
          <thead><tr><th>النسبة</th><th>الفترة السابقة</th><th>الفترة الحالية</th><th>10 سنوات تنبؤ</th><th>التفسير</th></tr></thead>
          <tbody id="activityRatios"></tbody>
        </table>
      </div>
    </div>
    <div class="col">
      <div class="card">
        <div class="card-header bg-danger" id="debtHeader">نسب المديونية</div>
        <table>
          <thead><tr><th>النسبة</th><th>الفترة السابقة</th><th>الفترة الحالية</th><th>10 سنوات تنبؤ</th><th>التفسير</th></tr></thead>
          <tbody id="debtRatios"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Charts مع خط التنبؤ -->
  <div class="row">
    <div class="col"><canvas id="liquidityChart"></canvas></div>
    <div class="col"><canvas id="profitabilityChart"></canvas></div>
    <div class="col"><canvas id="activityChart"></canvas></div>
    <div class="col"><canvas id="debtChart"></canvas></div>
  </div>

  <!-- المخاطر المتقدمة -->
  <div class="row mt-3">
    <div class="col">
      <div class="card">
        <div class="card-header bg-danger">مؤشر المخاطر المتوقع حسب السيناريو</div>
        <p id="riskIndex" class="alert alert-danger"></p>
      </div>
    </div>
    <div class="col">
      <div class="card">
        <div class="card-header bg-success">تنبؤ العائد المستقبلي (10 سنوات)</div>
        <p id="forecastReturn" class="alert alert-success"></p>
      </div>
    </div>
  </div>

</div>

<div class="footer">&copy; 2025 Financial Analyzer</div>

<script>
// إعدادات ديناميكية
let lang='AR', currency='EGP';
const body=document.body;
document.getElementById('toggleDarkMode').addEventListener('click',()=>{body.classList.toggle('dark-mode');body.classList.toggle('light-mode');});
document.getElementById('toggleLanguage').addEventListener('click',()=>{lang=lang==='AR'?'EN':'AR';updateLanguage();});
document.getElementById('currencySelect').addEventListener('change',(e)=>{currency=e.target.value;updateTables();});

// بيانات وهمية متقدمة مع 10 سنوات تنبؤ
const financialData={
  liquidity:[
    {ratio:'Current Ratio', prev:1.5, curr:1.8, descAR:'قدرة الشركة على تغطية الالتزامات القصيرة الأجل', descEN:'Ability to cover short-term obligations', forecast:[1.85,1.9,1.95,2.0,2.05,2.1,2.15,2.2,2.25,2.3]},
    {ratio:'Quick Ratio', prev:1.0, curr:1.2, descAR:'السيولة الفورية مقارنة بالخصوم القصيرة', descEN:'Immediate liquidity vs short-term liabilities', forecast:[1.22,1.25,1.28,1.3,1.33,1.35,1.38,1.4,1.42,1.45]}
  ],
  profitability:[
    {ratio:'ROA', prev:0.10, curr:0.12, descAR:'العائد على الأصول', descEN:'Return on Assets', forecast:[0.13,0.14,0.145,0.15,0.152,0.155,0.16,0.162,0.165,0.17]},
    {ratio:'Net Margin', prev:0.12, curr:0.15, descAR:'هامش الربح الصافي', descEN:'Net Profit Margin', forecast:[0.155,0.16,0.162,0.165,0.168,0.17,0.172,0.175,0.178,0.18]}
  ],
  activity:[
    {ratio:'Asset Turnover', prev:1.3, curr:1.5, descAR:'كفاءة استخدام الأصول', descEN:'Efficiency of asset use', forecast:[1.52,1.55,1.57,1.6,1.62,1.65,1.67,1.7,1.72,1.75]}
  ],
  debt:[
    {ratio:'Debt/Equity', prev:0.9, curr:0.8, descAR:'نسبة الدين إلى حقوق الملكية', descEN:'Debt to Equity Ratio', forecast:[0.78,0.76,0.75,0.73,0.72,0.7,0.68,0.66,0.65,0.63]}
  ]
};

// التحديث
function formatVal(val){return currency==='EGP'?val+' ج.م':currency==='USD'? '$'+val:'€'+val;}
function updateTables(){
  const tables={liquidity:'liquidityRatios',profitability:'profitabilityRatios',activity:'activityRatios',debt:'debtRatios'};
  for(const key in tables){
    const tbody=document.getElementById(tables[key]);
    tbody.innerHTML='';
    financialData[key].forEach(f=>{
      const forecastStr=f.forecast.map(v=>formatVal(v)).join(' | ');
      const tr=document.createElement('tr');
      tr.innerHTML=`<td>${lang==='AR'?f.ratio:f.ratio}</td><td>${formatVal(f.prev)}</td><td>${formatVal(f.curr)}</td><td>${forecastStr}</td><td>${lang==='AR'?f.descAR:f.descEN}</td>`;
      tbody.appendChild(tr);
    });
  }
}

// اللغة
function updateLanguage(){
  document.getElementById('pageTitle').innerText = lang==='AR'?'📊 التحليلات المالية الفائقة + تنبؤ 10 سنوات':'📊 Super Advanced Financial Analysis + 10 Years Forecast';
  document.getElementById('pageDesc').innerText = lang==='AR'?'جميع النسب والمؤشرات مع مقارنة بين الفترة السابقة والحالية + التنبؤات المستقبلية والمخاطر حسب السيناريوهات.':'All ratios and indicators with period comparison + future forecasts & risk scenarios.';
  document.getElementById('liquidityHeader').innerText = lang==='AR'?'نسب السيولة':'Liquidity Ratios';
  document.getElementById('profitabilityHeader').innerText = lang==='AR'?'نسب الربحية':'Profitability Ratios';
  document.getElementById('activityHeader').innerText = lang==='AR'?'نسب النشاط':'Activity Ratios';
  document.getElementById('debtHeader').innerText = lang==='AR'?'نسب المديونية':'Debt Ratios';
  updateTables();
}

// الرسوم البيانية + خط التنبؤ
let charts={};
function createCharts(){
  const ctxIds=['liquidityChart','profitabilityChart','activityChart','debtChart'];
  const dataKeys=['liquidity','profitability','activity','debt'];
  ctxIds.forEach((id,i)=>{
    const ctx=document.getElementById(id).getContext('2d');
    const labels=financialData[dataKeys[i]].map(f=>f.ratio);
    const datasets=[
      {label:lang==='AR'?'الفترة السابقة':'Previous', data:financialData[dataKeys[i]].map(f=>f.prev), backgroundColor:'rgba(220,53,69,0.6)'},
      {label:lang==='AR'?'الفترة الحالية':'Current', data:financialData[dataKeys[i]].map(f=>f.curr), backgroundColor:'rgba(13,110,253,0.6)'}
    ];
    // خط التنبؤ (المتوسط لكل نسبة)
    const forecastAvg=financialData[dataKeys[i]].map(f=>f.forecast.reduce((a,b)=>a+b,0)/f.forecast.length);
    datasets.push({label:lang==='AR'?'تنبؤ 10 سنوات':'10Y Forecast', data:forecastAvg, type:'line', borderColor:'orange', borderWidth:2, fill:false});
    charts[id]=new Chart(ctx,{type:'bar',data:{labels, datasets}, options:{responsive:true, plugins:{legend:{position:'top'}}}});
  });
}

// مؤشر المخاطر + تنبؤ العائد
function updateRiskForecast(){
  let avgRisk=(financialData.debt.reduce((a,f)=>a.forecast.reduce((x,y)=>x+y,0)/f.forecast.length,0)/financialData.debt.length*100).toFixed(1);
  document.getElementById('riskIndex').innerText=lang==='AR'?`مؤشر المخاطر المتوقع (10 سنوات): ${avgRisk}%`:`Expected Risk Index (10Y): ${avgRisk}%`;

  let forecastReturn=(financialData.profitability.reduce((a,f)=>a.forecast.reduce((x,y)=>x+y,0)/f.forecast.length,0)/financialData.profitability.length*100).toFixed(1);
  document.getElementById('forecastReturn').innerText=lang==='AR'?`تنبؤ العائد المستقبلي (10 سنوات): ${forecastReturn}%`:`Forecast Return (10Y): ${forecastReturn}%`;
}

// تنفيذ الكل
updateLanguage();
createCharts();
updateRiskForecast();
</script>

</body>
</html>

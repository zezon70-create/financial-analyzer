<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© | Financial Analyzer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: "Cairo", sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #e9f0ff, #ffffff);
      color: #222;
      transition: all 0.4s ease;
    }
    header {
      background: rgba(0,64,128,0.9);
      backdrop-filter: blur(10px);
      color: #fff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 25px;
    }
    header h1 { font-size: 20px; }
    nav button, nav select {
      margin: 0 5px;
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #fff;
      color: #004080;
      font-weight: bold;
    }
    nav button:hover { background: #f0f0f0; }
    .container {
      padding: 25px;
      max-width: 1200px;
      margin: auto;
    }
    h2 {
      color: #004080;
      border-bottom: 2px solid #004080;
      padding-bottom: 5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: rgba(255,255,255,0.8);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    th {
      background: #004080;
      color: #fff;
    }
    canvas {
      margin: 20px auto;
      display: block;
      max-width: 800px;
    }
    .comment {
      background: #f0f8ff;
      padding: 10px 15px;
      border-left: 4px solid #004080;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    footer {
      text-align: center;
      background: #004080;
      color: white;
      padding: 10px;
    }
    .dark-mode {
      background: #1c1c1c;
      color: #f5f5f5;
    }
    .dark-mode th { background: #222; }
    .dark-mode .comment { background: #2c2c2c; border-left-color: #00bfff; }
  </style>
</head>
<body>
  <header>
    <h1 id="pageTitle">ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h1>
    <nav>
      <button onclick="location.href='index.html'">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
      <button onclick="toggleDarkMode()">ğŸŒ™/â˜€ï¸</button>
      <select id="lang" onchange="changeLanguage()">
        <option value="ar">ğŸ‡ªğŸ‡¬ Ø¹Ø±Ø¨ÙŠ</option>
        <option value="en">ğŸ‡ºğŸ‡¸ English</option>
      </select>
    </nav>
  </header>

  <div class="container">
    <h2 id="ratiosTitle">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h2>
    <table id="ratiosTable">
      <thead>
        <tr><th>Ø§Ù„Ù†Ø³Ø¨Ø©</th><th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th><th>Ø§Ù„ØªÙØ³ÙŠØ±</th></tr>
      </thead>
      <tbody id="ratiosBody"></tbody>
    </table>

    <canvas id="ratiosChart"></canvas>

    <h2 id="evaTitle">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ©</h2>
    <div class="comment" id="evaComment"></div>
    <canvas id="evaChart"></canvas>

    <h2 id="forecastTitle">ğŸ”® Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ</h2>
    <div class="comment" id="forecastComment"></div>
    <canvas id="forecastChart"></canvas>
  </div>

  <footer>
    &copy; 2025 Financial Analyzer â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
  </footer>

  <script>
    // Dark Mode
    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
    }

    // Load data from Local Storage
    let data = JSON.parse(localStorage.getItem("financialData")) || {
      revenues: [1200000, 1000000],
      expenses: [700000, 600000],
      assets: [1300000, 1150000],
      liabilities: [400000, 350000],
      equity: [900000, 800000],
    };

    // Ratios
    const ratios = {
      "Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ": data.revenues[0] ? (data.revenues[0] - data.expenses[0]) / data.revenues[0] : 0,
      "Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£ØµÙˆÙ„": data.assets[0] ? ((data.revenues[0] - data.expenses[0]) / data.assets[0]) : 0,
      "Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©": data.equity[0] ? ((data.revenues[0] - data.expenses[0]) / data.equity[0]) : 0,
      "Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©": data.assets[0] ? (data.liabilities[0] / data.assets[0]) : 0,
    };

    // Populate Table
    const tbody = document.getElementById("ratiosBody");
    for (const [name, value] of Object.entries(ratios)) {
      const tr = document.createElement("tr");
      const interpretation =
        value > 0.25 ? "ğŸ“ˆ Ø£Ø¯Ø§Ø¡ Ù‚ÙˆÙŠ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ ÙƒÙØ§Ø¡Ø© Ø¹Ø§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©." :
        value > 0 ? "âš–ï¸ Ø£Ø¯Ø§Ø¡ Ù…ØªÙˆØ³Ø· ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ­Ø³ÙŠÙ† ÙÙŠ Ø§Ù„ÙƒÙØ§Ø¡Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©." :
        "ğŸ”» Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ù„Ø¨ÙŠØ© ØªØ³ØªØ¯Ø¹ÙŠ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©.";
      tr.innerHTML = `<td>${name}</td><td>${(value*100).toFixed(2)}%</td><td>${interpretation}</td>`;
      tbody.appendChild(tr);
    }

    // Ratios Chart
    new Chart(document.getElementById("ratiosChart"), {
      type: "bar",
      data: {
        labels: Object.keys(ratios),
        datasets: [{
          label: "Ø§Ù„Ù‚ÙŠÙ… (%)",
          data: Object.values(ratios).map(v => v*100),
          backgroundColor: ["#004080","#00bfff","#0077cc","#3399ff"]
        }]
      }
    });

    // EVA Chart
    const eva = (data.revenues[0] - data.expenses[0]) - (0.1 * data.equity[0]);
    document.getElementById("evaComment").innerText =
      eva > 0 ? "âœ… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠÙˆÙ„Ù‘Ø¯ Ù‚ÙŠÙ…Ø© Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ù…Ø¶Ø§ÙØ© Ù„Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†." :
      "âš ï¸ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ© Ø³Ù„Ø¨ÙŠØ©ØŒ ÙŠØ¬Ø¨ ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„.";
    new Chart(document.getElementById("evaChart"), {
      type: "doughnut",
      data: {
        labels: ["Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ©", "ØªÙƒÙ„ÙØ© Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„"],
        datasets: [{
          data: [eva > 0 ? eva : 0, eva > 0 ? 0 : -eva],
          backgroundColor: ["#28a745", "#dc3545"]
        }]
      }
    });

    // Forecast (ØªÙ†Ø¨Ø¤ Ø¨Ø³ÙŠØ· Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù…Ùˆ)
    const growth = ((data.revenues[0] - data.revenues[1]) / data.revenues[1]) || 0;
    const forecastRevenue = data.revenues[0] * (1 + growth);
    document.getElementById("forecastComment").innerText =
      growth > 0 ? "ğŸ“Š Ù…Ù† Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ù†Ù…Ùˆ Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©." :
      "ğŸ“‰ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙŠØªØ±Ø§Ø¬Ø¹ ÙˆÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ¯Ø®Ù„ Ø¥Ø¯Ø§Ø±ÙŠ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø§ØªØ¬Ø§Ù‡.";
    new Chart(document.getElementById("forecastChart"), {
      type: "line",
      data: {
        labels: ["2022","2023","2024 (ØªÙ†Ø¨Ø¤)"],
        datasets: [{
          label: "Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",
          data: [data.revenues[1], data.revenues[0], forecastRevenue],
          borderColor: "#004080",
          fill: false
        }]
      }
    });

    // Translation
    function changeLanguage() {
      const lang = document.getElementById("lang").value;
      const ar = lang === "ar";
      document.documentElement.dir = ar ? "rtl" : "ltr";
      document.getElementById("pageTitle").innerText = ar ? "ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©" : "ğŸ“Š Advanced Analytics";
      document.getElementById("ratiosTitle").innerText = ar ? "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ©" : "Financial Ratios Analysis";
      document.getElementById("evaTitle").innerText = ar ? "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ© Ø§Ù„Ù…Ø¶Ø§ÙØ©" : "Economic Value Added (EVA)";
      document.getElementById("forecastTitle").innerText = ar ? "ğŸ”® Ø§Ù„ØªÙ†Ø¨Ø¤ Ø¨Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠ" : "ğŸ”® Performance Forecasting";
    }
  </script>
</body>
</html>

<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title data-translate-key="pageTitle">التحليلات المتقدمة — المحلل المالي</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet"/>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body data-theme="light">

    <div class="toast-area" id="toastArea" aria-live="polite"></div>

    <header class="site-header-adv">
        <div class="brand">
            <img src="assets/logo.png" alt="logo">
            <div>
                <div class="title" data-translate-key="brandTitle">المحلل المالي — Advanced</div>
                <div class="small-muted-light" data-translate-key="brandSub">تحليلات متقدمة</div>
            </div>
        </div>
        <nav class="controls" role="navigation">
            <a class="btn btn-sm btn-outline-light" href="report.html" data-translate-key="navReport" title="التقرير"><i class="bi bi-file-earmark-text"></i></a>
            <select id="languageSelect" class="form-select form-select-sm"></select>
            <div class="form-check form-switch mb-0">
                <input class="form-check-input" id="darkModeToggle" type="checkbox" role="switch">
            </div>
            <button id="exportPdfBtn" class="btn btn-sm btn-glow ms-2"><i class="bi bi-file-earmark-pdf"></i> <span data-translate-key="exportPdf">تصدير</span></button>
        </nav>
    </header>

    <main class="container-main" id="mainArea">
        <section class="card-surface">
            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                <div>
                    <h4 data-translate-key="pageHeader">تحليلات متقدمة</h4>
                    <div class="muted" data-translate-key="pageDesc">يتم تحديث جميع التحليلات والنسب فورًا بناءً على البيانات المتاحة.</div>
                </div>
                <div class="d-flex align-items-center gap-2">
                    <label for="dataSource" class="form-label mb-0" data-translate-key="sourceLabel">مصدر البيانات:</label>
                    <select id="dataSource" class="form-select form-select-sm" style="min-width: 200px;"></select>
                </div>
            </div>
        </section>

        <section class="analysis-grid mt-3">
            <div class="analysis-main">
                <div class="card-surface mb-3">
                    <h6 data-translate-key="ratiosTitle">النسب المالية الرئيسية</h6>
                    <div class="table-responsive">
                        <table class="table table-sm table-striped">
                            <thead><tr><th data-translate-key="thRatio">النسبة</th><th data-translate-key="thValue">القيمة</th><th data-translate-key="thComment">تحليل</th></tr></thead>
                            <tbody id="ratiosBody"></tbody>
                        </table>
                    </div>
                </div>
                <div class="card-surface">
                    <h6 data-translate-key="trendTitle">اتجاهات وتوقعات الإيرادات</h6>
                    <div class="chart-wrap">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>
            </div>
            <aside class="analysis-sidebar">
                <div class="card-surface mb-3">
                    <h6 data-translate-key="summaryTitle">ملخص ذكي</h6>
                    <div id="smartSummary" class="analysis-comment"></div>
                </div>
                <div class="card-surface mb-3">
                    <h6 data-translate-key="alertsTitle">تنبيهات ومخاطر</h6>
                    <div id="alertsArea" class="small-muted"></div>
                </div>
                 <div class="card-surface">
                    <h6 data-translate-key="dataTitle">معاينة البيانات</h6>
                    <div class="table-responsive" style="max-height: 220px;">
                        <table class="table table-sm">
                            <thead><tr><th data-translate-key="thAccount">الحساب</th><th data-translate-key="thDebit">مدين</th><th data-translate-key="thCredit">دائن</th></tr></thead>
                            <tbody id="previewBody"></tbody>
                        </table>
                    </div>
                </div>
            </aside>
        </section>

        <footer class="text-center small muted mt-4">&copy; 2025 المحلل المالي</footer>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    
    <script src="js/advanced-app.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ุงูุชุญูููุงุช ุงููุงููุฉ ุงููุงุฆูุฉ | Financial Analyzer</title>

<!-- Bootstrap RTL CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
/* ุชูุณููุงุช ุฏุงุฎููุฉ ูุงููุฉ */
body.light-mode { background:#f7f9fc; color:#212529; }
body.dark-mode { background:#121212; color:#eee; }
.site-header { position: sticky; top:0; z-index:1000; }
.logo { height:40px; }
.card { border-radius:10px; }
.card-header { font-weight:bold; }
.table th, .table td { vertical-align: middle !important; }
.watermark { position: fixed; top:50%; left:50%; transform: translate(-50%, -50%); opacity:0.03; z-index:0; pointer-events:none; }
.tooltip-inner { max-width:300px; text-align:right; }
</style>
</head>
<body class="light-mode">

<header class="site-header navbar navbar-expand-lg navbar-dark bg-primary px-3">
  <a class="navbar-brand d-flex align-items-center" href="index.html">
    <img src="assets/logo.png" alt="logo" class="logo me-2">
    <div><strong>Financial Analyzer</strong></div>
  </a>
  <div class="ms-auto d-flex gap-2">
    <select id="currencySelect" class="form-select form-select-sm">
      <option value="EGP">ุฌููู</option>
      <option value="USD">USD</option>
      <option value="EUR">EUR</option>
    </select>
    <button id="toggleDarkMode" class="btn btn-outline-light btn-sm"><i class="fa fa-moon"></i></button>
  </div>
</header>

<div class="watermark">
  <img src="assets/logo.png" alt="watermark">
</div>

<main class="container py-4">

  <div class="text-center mb-4">
    <h1>๐ ุงูุชุญูููุงุช ุงููุงููุฉ ุงููุงุฆูุฉ</h1>
    <p class="lead">ุนุฑุถ ูุงูุฉ ุงูุชุญูููุงุชุ ุงููุณุจุ ุงูุฑุณูู ุงูุชูุงุนููุฉุ ุงูุชูุจุคุงุชุ ููุคุดุฑุงุช ุงููุฎุงุทุฑ ูุงูุนุงุฆุฏ.</p>
  </div>

  <!-- Cards & Ratios -->
  <div class="row g-4">

    <!-- Liquidity Ratios -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-primary text-white">ูุณุจ ุงูุณูููุฉ</div>
        <div class="card-body table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-light">
              <tr><th>ุงููุณุจุฉ</th><th>ุงููููุฉ</th><th>ุชูุณูุฑ</th></tr>
            </thead>
            <tbody id="liquidityRatios"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Profitability Ratios -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-success text-white">ูุณุจ ุงูุฑุจุญูุฉ</div>
        <div class="card-body table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-light"><tr><th>ุงููุณุจุฉ</th><th>ุงููููุฉ</th><th>ุชูุณูุฑ</th></tr></thead>
            <tbody id="profitabilityRatios"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Activity Ratios -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-warning">ูุณุจ ุงููุดุงุท</div>
        <div class="card-body table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-light"><tr><th>ุงููุณุจุฉ</th><th>ุงููููุฉ</th><th>ุชูุณูุฑ</th></tr></thead>
            <tbody id="activityRatios"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Debt Ratios -->
    <div class="col-lg-6">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-danger text-white">ูุณุจ ุงููุฏููููุฉ</div>
        <div class="card-body table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-light"><tr><th>ุงููุณุจุฉ</th><th>ุงููููุฉ</th><th>ุชูุณูุฑ</th></tr></thead>
            <tbody id="debtRatios"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Advanced Predictive & Risk -->
    <div class="col-12">
      <div class="card shadow-sm h-100">
        <div class="card-header bg-info text-white">ุชูุจุค ููุฎุงุทุฑ ูุนุงุฆุฏ</div>
        <div class="card-body table-responsive">
          <table class="table table-bordered table-sm">
            <thead class="table-light">
              <tr><th>ุงููุคุดุฑ</th><th>ุงููููุฉ</th><th>ุชูุณูุฑ</th></tr>
            </thead>
            <tbody id="advancedRatios"></tbody>
          </table>
        </div>
      </div>
    </div>

  </div>

  <!-- Charts Section -->
  <div class="row g-4 mt-3">
    <div class="col-md-6"><div class="card shadow-sm p-3"><h6>ุงูุณูููุฉ</h6><canvas id="liquidityChart" height="200"></canvas></div></div>
    <div class="col-md-6"><div class="card shadow-sm p-3"><h6>ุงูุฑุจุญูุฉ</h6><canvas id="profitabilityChart" height="200"></canvas></div></div>
    <div class="col-md-6"><div class="card shadow-sm p-3"><h6>ุงููุดุงุท</h6><canvas id="activityChart" height="200"></canvas></div></div>
    <div class="col-md-6"><div class="card shadow-sm p-3"><h6>ุงููุฏููููุฉ</h6><canvas id="debtChart" height="200"></canvas></div></div>
    <div class="col-12"><div class="card shadow-sm p-3"><h6>ุงูุชูุจุคุงุช & ุงููุฎุงุทุฑ & ุงูุนุงุฆุฏ</h6><canvas id="riskChart" height="300"></canvas></div></div>
  </div>

</main>

<footer class="bg-light text-center py-3 small">&copy; 2025 ุงููุญูู ุงููุงูู โ Financial Analyzer</footer>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Main Advanced JS -->
<script>
// ุจูุงูุงุช ููููุฉ ููุชุฌุฑุจุฉุ ูููู ุงุณุชุจุฏุงููุง ุจุงูุจูุงูุงุช ุงูุญููููุฉ
const trialData = window.__trialData || [
  { account:"Cash", code:"1001", debit:50000, credit:0, type:"asset" },
  { account:"Revenue", code:"4001", debit:0, credit:70000, type:"revenue" },
  { account:"Expense", code:"5001", debit:20000, credit:0, type:"expense" },
  { account:"Loan", code:"2001", debit:0, credit:15000, type:"liability" }
];

// ุญุณุงุจ ูุคุดุฑุงุช
function calculateRatios(data){
  const ratios = { liquidity:[], profitability:[], activity:[], debt:[], advanced:[] };
  let totalAssets = 0, totalLiabilities=0, totalEquity=0, totalRevenue=0, totalExpense=0;
  data.forEach(r=>{
    if(r.type==="asset") totalAssets+=r.debit-r.credit;
    else if(r.type==="liability") totalLiabilities+=r.credit-r.debit;
    else if(r.type==="equity") totalEquity+=r.credit-r.debit;
    else if(r.type==="revenue") totalRevenue+=r.credit-r.debit;
    else if(r.type==="expense") totalExpense+=r.debit-r.credit;
  });

  // ูุณุจ ุงูุณูููุฉ
  ratios.liquidity.push({name:"ุงููุณุจุฉ ุงูุญุงููุฉ", value: (totalAssets/totalLiabilities).toFixed(2), explanation:"ุงูุณูููุฉ ููุงุจู ุงูุงูุชุฒุงูุงุช ุงููุตูุฑุฉ ุงูุฃุฌู"});
  ratios.liquidity.push({name:"ุงููุณุจุฉ ุงูุณุฑูุนุฉ", value: ((totalAssets-totalExpense)/totalLiabilities).toFixed(2), explanation:"ุงูุณูููุฉ ุงููุนููุฉ ุจุฏูู ุงููุฎุฒูู"});

  // ุงูุฑุจุญูุฉ
  const netIncome = totalRevenue-totalExpense;
  ratios.profitability.push({name:"ุตุงูู ุงูุฑุจุญ", value: netIncome.toFixed(2), explanation:"ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช ูุทุฑูุญุงู ููู ุงููุตุฑููุงุช"});
  ratios.profitability.push({name:"ูุงูุด ุงูุฑุจุญ", value: (netIncome/totalRevenue*100).toFixed(2)+"%", explanation:"ูุณุจุฉ ุงูุฑุจุญ ูู ุงูุฅูุฑุงุฏุงุช"});

  // ุงููุดุงุท
  ratios.activity.push({name:"ูุนุฏู ุฏูุฑุงู ุงูุฃุตูู", value: (totalRevenue/totalAssets).toFixed(2), explanation:"ุนุฏุฏ ูุฑุงุช ุงุณุชุฎุฏุงู ุงูุฃุตูู ูุชุญููู ุงูุฅูุฑุงุฏุงุช"});
  ratios.activity.push({name:"ูุนุฏู ุฏูุฑุงู ุงููุฎุฒูู", value: (totalExpense/totalAssets).toFixed(2), explanation:"ุชูุฏูุฑ ุณุฑุนุฉ ุงุณุชููุงู ุงููุฎุฒูู"});

  // ุงููุฏููููุฉ
  ratios.debt.push({name:"ูุณุจุฉ ุงูุฏูู", value: (totalLiabilities/totalAssets*100).toFixed(2)+"%", explanation:"ูุณุจุฉ ุงูุชุฒุงู ุงูุดุฑูุฉ ุจุงูุฏูู"});
  ratios.debt.push({name:"ูุณุจุฉ ุงูุฏูู ุฅูู ุญููู ุงูููููุฉ", value: (totalLiabilities/totalEquity).toFixed(2), explanation:"ููุงุฑูุฉ ุงูุฏูู ุจุญููู ุงูููููุฉ"});

  // ูุคุดุฑุงุช ูุชูุฏูุฉ
  ratios.advanced.push({name:"CAGR ุงูุนุงุฆุฏ ุงูุณููู ุงููุฑูุจ", value: ((Math.pow(totalRevenue/totalAssets,1/3)-1)*100).toFixed(2)+"%", explanation:"ุชูุฏูุฑ ุงูุนุงุฆุฏ ุงูุณููู ุงููุฑูุจ"});
  ratios.advanced.push({name:"ูุคุดุฑ ุงููุฎุงุทุฑ", value: (Math.random()*10).toFixed(2), explanation:"ูุคุดุฑ ุงููุฎุงุทุฑ ุงูุงูุชุฑุงุถู ุจูุงุกู ุนูู ุชููุจ ุงูุนูุงุฆุฏ"});
  ratios.advanced.push({name:"ุงูุนุงุฆุฏ ุงููุชููุน", value: (netIncome/totalAssets*100).toFixed(2)+"%", explanation:"ุงูุนุงุฆุฏ ุงููุชููุน ุนูู ุงูุฃุตูู"});

  return ratios;
}

// Render ุฌุฏุงูู
function renderRatios(r){
  const fillTable = (id, arr)=>{
    const tbody = document.getElementById(id);
    tbody.innerHTML = arr.map(x=>`<tr><td>${x.name}</td><td>${x.value}</td><td>${x.explanation}</td></tr>`).join("");
  };
  fillTable("liquidityRatios", r.liquidity);
  fillTable("profitabilityRatios", r.profitability);
  fillTable("activityRatios", r.activity);
  fillTable("debtRatios", r.debt);
  fillTable("advancedRatios", r.advanced);
}

// Render Charts
function renderCharts(r){
  function createBarChart(ctx, labels, data, color){
    return new Chart(ctx,{type:"bar", data:{labels, datasets:[{label:"ุงููููุฉ",data,color,backgroundColor:color}]}, options:{responsive:true, plugins:{legend:{display:false}}}});
  }
  const lc = document.getElementById("liquidityChart").getContext("2d");
  createBarChart(lc, r.liquidity.map(x=>x.name), r.liquidity.map(x=>parseFloat(x.value)), 'rgba(0,123,255,0.7)');
  const pc = document.getElementById("profitabilityChart").getContext("2d");
  createBarChart(pc, r.profitability.map(x=>x.name), r.profitability.map(x=>parseFloat(x.value)), 'rgba(40,167,69,0.7)');
  const ac = document.getElementById("activityChart").getContext("2d");
  createBarChart(ac, r.activity.map(x=>x.name), r.activity.map(x=>parseFloat(x.value)), 'rgba(255,193,7,0.7)');
  const dc = document.getElementById("debtChart").getContext("2d");
  createBarChart(dc, r.debt.map(x=>x.name), r.debt.map(x=>parseFloat(x.value)), 'rgba(220,53,69,0.7)');

  // Risk Chart
  const rc = document.getElementById("riskChart").getContext("2d");
  new Chart(rc, {
    type:"line",
    data:{
      labels:r.advanced.map(x=>x.name),
      datasets:[{label:"ุงููููุฉ",data:r.advanced.map(x=>parseFloat(x.value)), borderColor:'rgba(23,162,184,1)', backgroundColor:'rgba(23,162,184,0.2)', tension:0.4}]
    },
    options:{responsive:true}
  });
}

// Dark/Light Mode
document.getElementById("toggleDarkMode").addEventListener("click",()=>{
  document.body.classList.toggle("dark-mode");
  document.body.classList.toggle("light-mode");
});

const ratios = calculateRatios(trialData);
renderRatios(ratios);
renderCharts(ratios);
</script>

</body>
</html>

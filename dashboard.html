<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ultra Global Dashboard | Financial Analyzer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
  body { margin:0; font-family:'Cairo', sans-serif; background:#f0f2f5; transition: all 0.3s ease; color:#333;}
  .dark-mode { background:#1c1c1c; color:#f1f1f1;}
  header { display:flex; justify-content:space-between; align-items:center; padding:15px; background: linear-gradient(90deg,#004080,#00bfff); color:#fff;}
  header img { height:40px; border-radius:6px;}
  nav button, nav select { margin:0 5px; padding:8px 12px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:0.3s;}
  nav select { border:1px solid #ccc; }
  nav button:hover, nav select:hover { opacity:0.8;}
  .container { padding:20px; }
  h1,h2 { color:#004080; }
  table { width:100%; border-collapse:collapse; margin-bottom:20px; background: rgba(255,255,255,0.85); backdrop-filter: blur(10px); border-radius:6px; overflow:hidden;}
  table th, table td { padding:10px; text-align:center; border-bottom:1px solid #ccc; }
  table th { background: rgba(0,64,128,0.9); color:#fff; }
  footer { background:#004080; color:#fff; text-align:center; padding:10px; }
  canvas { margin:20px 0; max-width:100%; }
  .controls { margin:20px 0; display:flex; flex-wrap:wrap; gap:10px; align-items:center;}
  .comment { margin:10px 0; font-style:italic; }
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:10px;">
    <img src="logo.png" alt="Logo">
    <span style="font-size:20px;font-weight:bold;" id="headerTitle">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©</span>
  </div>
  <nav>
    <button onclick="location.href='index.html'" id="homeBtn">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="location.href='report.html'" id="reportBtn">ğŸ“‘ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ</button>
    <button onclick="location.href='advanced.html'" id="advancedBtn">ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</button>
    <button onclick="toggleDarkMode()" id="darkModeBtn">ğŸŒ™/â˜€ï¸</button>
    <select id="lang" onchange="changeLanguage()">
      <option value="ar">ğŸ‡ªğŸ‡¬ Ø¹Ø±Ø¨ÙŠ</option>
      <option value="en">ğŸ‡ºğŸ‡¸ English</option>
    </select>
    <select id="currency" onchange="updateCurrency()">
      <option value="EGP">EGP</option>
      <option value="USD">USD</option>
      <option value="EUR">EUR</option>
    </select>
    <button onclick="exportPDF()" id="exportBtn">ğŸ“„ PDF</button>
  </nav>
</header>

<div class="container">
  <h1 id="pageTitle">ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©</h1>

  <div class="controls">
    <label id="yearLabel">ğŸ“… Ø§Ø®ØªØ± Ø§Ù„Ø³Ù†Ø©: </label>
    <select id="yearSelect" onchange="refreshDashboard()"></select>
  </div>

  <h2 id="bsTitle">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</h2>
  <table id="balanceSheet"></table>
  <div class="comment" id="bsComment"></div>
  <canvas id="balanceChart"></canvas>

  <h2 id="isTitle">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h2>
  <table id="incomeStatement"></table>
  <div class="comment" id="isComment"></div>
  <canvas id="incomeChart"></canvas>

  <h2 id="cfTitle">Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</h2>
  <table id="cashFlow"></table>
  <div class="comment" id="cfComment"></div>
  <canvas id="cashChart"></canvas>

  <h2 id="eqTitle">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h2>
  <table id="equity"></table>
  <div class="comment" id="eqComment"></div>
  <canvas id="equityChart"></canvas>
</div>

<footer>
  &copy; 2025 Financial Analyzer - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©
</footer>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© - Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ù…Ù† LocalStorage
let currency = 'EGP';
let lang = 'ar';
let data = JSON.parse(localStorage.getItem('financialData')) || {
  "years": ["2023","2022","2021"],
  "balanceSheet": {"Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©":[500000,450000,400000],"Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©":[800000,700000,600000],"Ø§Ù„Ø®ØµÙˆÙ…":[400000,350000,300000],"Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©":[900000,800000,700000]},
  "incomeStatement": {"Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª":[1200000,1000000,900000],"Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª":[700000,600000,500000],"ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­":[500000,400000,400000]},
  "cashFlow": {"Ø§Ù„ØªØ´ØºÙŠÙ„":[300000,250000,200000],"Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±":[-100000,-80000,-70000],"Ø§Ù„ØªÙ…ÙˆÙŠÙ„":[50000,60000,50000]},
  "equity": {"Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„":[500000,500000,500000],"Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø­ØªØ¬Ø²Ø©":[400000,300000,200000]}
};

function toggleDarkMode(){document.body.classList.toggle('dark-mode');}

function populateYears(){
  let ySelect = document.getElementById('yearSelect');
  ySelect.innerHTML='';
  data.years.forEach(year=>{
    let opt = document.createElement('option');
    opt.value=year; opt.textContent=year;
    ySelect.appendChild(opt);
  });
}

function generateTable(tableId, dataset, yearIndex){
  let table = document.getElementById(tableId);
  table.innerHTML='';
  let thead = document.createElement('thead');
  let tr = document.createElement('tr');
  tr.innerHTML=`<th id="colItem">Ø§Ù„Ø¨Ù†Ø¯</th><th>${data.years[yearIndex]}</th>`;
  if(data.years[yearIndex-1]) tr.innerHTML+=`<th>${data.years[yearIndex-1]}</th><th id="colDiff">Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù</th>`;
  thead.appendChild(tr); table.appendChild(thead);
  let tbody = document.createElement('tbody');
  for(let item in dataset){
    let valCurrent = dataset[item][yearIndex];
    let valPrev = dataset[item][yearIndex-1]||0;
    let diff = valPrev?(((valCurrent-valPrev)/valPrev)*100).toFixed(1)+'%':'=';
    let trd = document.createElement('tr');
    trd.innerHTML=`<td>${item}</td><td>${valCurrent.toLocaleString()} ${currency}</td>`+
                  (valPrev?`<td>${valPrev.toLocaleString()} ${currency}</td><td>${diff}</td>`:'');
    tbody.appendChild(trd);
  }
  table.appendChild(tbody);
}

function updateCharts(yearIndex){
  new Chart(document.getElementById('balanceChart'), {
    type:'bar',
    data:{labels:Object.keys(data.balanceSheet),datasets:[
      {label:data.years[yearIndex],data:Object.values(data.balanceSheet).map(a=>a[yearIndex]),backgroundColor:'#004080'},
      {label:data.years[yearIndex-1]||'',data:Object.values(data.balanceSheet).map(a=>a[yearIndex-1]||0),backgroundColor:'#00bfff'}
    ]}
  });
  new Chart(document.getElementById('incomeChart'), {
    type:'line',
    data:{labels:Object.keys(data.incomeStatement),datasets:[
      {label:data.years[yearIndex],data:Object.values(data.incomeStatement).map(a=>a[yearIndex]),borderColor:'#004080',fill:false},
      {label:data.years[yearIndex-1]||'',data:Object.values(data.incomeStatement).map(a=>a[yearIndex-1]||0),borderColor:'#00bfff',fill:false}
    ]}
  });
  new Chart(document.getElementById('cashChart'), {
    type:'pie',
    data:{labels:Object.keys(data.cashFlow),datasets:[{data:Object.values(data.cashFlow).map(a=>a[yearIndex]),backgroundColor:['#28a745','#ffc107','#dc3545']}]}
  });
  new Chart(document.getElementById('equityChart'), {
    type:'doughnut',
    data:{labels:Object.keys(data.equity),datasets:[{data:Object.values(data.equity).map(a=>a[yearIndex]),backgroundColor:['#004080','#00bfff']}]}
  });
}

function generateComments(yearIndex){
  document.getElementById('bsComment').textContent='Ø§Ù„Ø£ØµÙˆÙ„ ÙˆØ§Ù„Ø®ØµÙˆÙ… ØªØ´ÙŠØ± Ø¥Ù„Ù‰ ØªÙˆØ§Ø²Ù† Ø¬ÙŠØ¯.'; 
  document.getElementById('isComment').textContent='ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ ÙÙŠ Ø§Ø±ØªÙØ§Ø¹ Ù…Ø³ØªÙ‚Ø±ØŒ Ø£Ø¯Ø§Ø¡ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ.'; 
  document.getElementById('cfComment').textContent='Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ© Ù‚ÙˆÙŠØ©ØŒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±Ø§Øª Ù…Ø¹ØªØ¯Ù„Ø©.'; 
  document.getElementById('eqComment').textContent='Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© Ù…ØªÙ†Ø§Ù…ÙŠØ©ØŒ Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ù…Ø³ØªÙ‚Ø±.';
}

function refreshDashboard(){
  let yearIndex = document.getElementById('yearSelect').selectedIndex;
  generateTable('balanceSheet',data.balanceSheet,yearIndex);
  generateTable('incomeStatement',data.incomeStatement,yearIndex);
  generateTable('cashFlow',data.cashFlow,yearIndex);
  generateTable('equity',data.equity,yearIndex);
  updateCharts(yearIndex);
  generateComments(yearIndex);
}

function updateCurrency(){
  currency = document.getElementById('currency').value;
  refreshDashboard();
}

function changeLanguage(){
  lang = document.getElementById('lang').value;
  if(lang==='en'){
    document.getElementById('headerTitle').textContent='Financial Dashboard';
    document.getElementById('pageTitle').textContent='ğŸ“Š Financial Dashboard';
    document.getElementById('yearLabel').textContent='ğŸ“… Select Year:';
    document.getElementById('bsTitle').textContent='Balance Sheet';
    document.getElementById('isTitle').textContent='Income Statement';
    document.getElementById('cfTitle').textContent='Cash Flow Statement';
    document.getElementById('eqTitle').textContent='Equity Statement';
    document.getElementById('homeBtn').textContent='ğŸ  Home';
    document.getElementById('reportBtn').textContent='ğŸ“‘ Report';
    document.getElementById('advancedBtn').textContent='ğŸ“Š Advanced';
    document.getElementById('darkModeBtn').textContent='ğŸŒ™/â˜€ï¸';
    document.getElementById('exportBtn').textContent='ğŸ“„ Export PDF';
    // Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
    refreshDashboard();
  }else{
    document.getElementById('headerTitle').textContent='Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©';
    document.getElementById('pageTitle').textContent='ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„ÙŠØ©';
    document.getElementById('yearLabel').textContent='ğŸ“… Ø§Ø®ØªØ± Ø§Ù„Ø³Ù†Ø©:';
    document.getElementById('bsTitle').textContent='Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©';
    document.getElementById('isTitle').textContent='Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„';
    document.getElementById('cfTitle').textContent='Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©';
    document.getElementById('eqTitle').textContent='Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©';
    document.getElementById('homeBtn').textContent='ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
    document.getElementById('reportBtn').textContent='ğŸ“‘ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ';
    document.getElementById('advancedBtn').textContent='ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©';
    document.getElementById('darkModeBtn').textContent='ğŸŒ™/â˜€ï¸';
    document.getElementById('exportBtn').textContent='ğŸ“„ PDF';
    refreshDashboard();
  }
}

function exportPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text("Financial Dashboard Report",20,20);
  doc.save("dashboard.pdf");
}

populateYears();
refreshDashboard();
</script>
</body>
</html>
